---
keywords: fastai
title: Python API Client Wrapper Demo
nb_path: _notebooks/2022-08-23-python-client-library-demo.ipynb
layout: notebook
---

<!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-08-23-python-client-library-demo.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Import-client-libraries">Import client libraries<a class="anchor-link" href="#Import-client-libraries"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">rrap_mds_is_data_api</span>
<span class="kn">import</span> <span class="nn">rrap_mds_is_prov_api</span>
<span class="kn">import</span> <span class="nn">rrap_mds_is_registry_api</span>
<span class="kn">import</span> <span class="nn">rrap_mds_is_landing_portal_api</span>
<span class="kn">from</span> <span class="nn">mdsisclienttools.auth.TokenManager</span> <span class="kn">import</span> <span class="n">DeviceFlowManager</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Setup-authorisation">Setup authorisation<a class="anchor-link" href="#Setup-authorisation"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_token</span> <span class="o">=</span> <span class="n">DeviceFlowManager</span><span class="p">(</span>
    <span class="n">stage</span><span class="o">=</span><span class="s2">&quot;TEST&quot;</span><span class="p">,</span>
    <span class="n">keycloak_endpoint</span><span class="o">=</span><span class="s2">&quot;https://auth.dev.rrap-is.com/auth/realms/rrap&quot;</span>
<span class="p">)</span><span class="o">.</span><span class="n">get_token</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Attempting to generate authorisation tokens.

Looking for existing tokens in local storage.

Validating found tokens

Found tokens valid, using.

</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Demonstrate-registry-API-client">Demonstrate registry API client<a class="anchor-link" href="#Demonstrate-registry-API-client"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">rrap_mds_is_registry_api.configuration</span> <span class="kn">import</span> <span class="n">Configuration</span>
<span class="kn">import</span> <span class="nn">rrap_mds_is_registry_api.apis</span> <span class="k">as</span> <span class="nn">registry_apis</span>
<span class="kn">import</span> <span class="nn">rrap_mds_is_registry_api.models</span> <span class="k">as</span> <span class="nn">registry_models</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># We want token to be ready at the time that we call the API so </span>
<span class="c1"># write a function which generates the config on demand</span>
<span class="k">def</span> <span class="nf">get_config</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Configuration</span><span class="p">:</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">Configuration</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s2">&quot;https://registry-api.testing.rrap-is.com&quot;</span><span class="p">)</span>
    <span class="n">config</span><span class="o">.</span><span class="n">access_token</span> <span class="o">=</span> <span class="n">get_token</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">config</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_client</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">rrap_mds_is_registry_api</span><span class="o">.</span><span class="n">ApiClient</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">rrap_mds_is_registry_api</span><span class="o">.</span><span class="n">ApiClient</span><span class="p">(</span>
        <span class="n">configuration</span><span class="o">=</span><span class="n">get_config</span><span class="p">()</span>
    <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">person_api</span> <span class="o">=</span> <span class="n">registry_apis</span><span class="o">.</span><span class="n">PersonApi</span><span class="p">(</span><span class="n">get_client</span><span class="p">())</span>
<span class="n">all_people</span> <span class="o">=</span> <span class="n">person_api</span><span class="o">.</span><span class="n">list_agent_person</span><span class="p">(</span><span class="n">_check_return_type</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">all_people</span><span class="o">.</span><span class="n">items</span>
<span class="n">example_people</span><span class="p">:</span> <span class="n">registry_models</span><span class="o">.</span><span class="n">ItemPerson</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">person</span><span class="p">:</span> <span class="n">person</span><span class="p">[</span><span class="s1">&#39;first_name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;John&quot;</span> <span class="ow">and</span> <span class="n">person</span><span class="p">[</span><span class="s1">&#39;last_name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Doe&#39;</span><span class="p">,</span> <span class="n">items</span><span class="p">))</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">example_people</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
<span class="n">example_person</span> <span class="o">=</span> <span class="n">example_people</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">example_person</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{&#39;display_name&#39;: &#39;Reef Modeller for eReef&#39;, &#39;first_name&#39;: &#39;John&#39;, &#39;last_name&#39;: &#39;Doe&#39;, &#39;email&#39;: &#39;John.Doe@uni-of.au&#39;, &#39;orcid&#39;: &#39;https://orcid.org/0000-0000-000-0000&#39;, &#39;id&#39;: &#39;10378.1/1687652&#39;, &#39;created_timestamp&#39;: 1658822301, &#39;updated_timestamp&#39;: 1658822301, &#39;item_category&#39;: &#39;AGENT&#39;, &#39;item_subtype&#39;: &#39;PERSON&#39;}
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">person_api</span> <span class="o">=</span> <span class="n">registry_apis</span><span class="o">.</span><span class="n">PersonApi</span><span class="p">(</span><span class="n">get_client</span><span class="p">())</span>
<span class="n">result_person</span> <span class="o">=</span> <span class="n">person_api</span><span class="o">.</span><span class="n">fetch_agent_person</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">example_person</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span><span class="n">_check_return_type</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result_person</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{&#39;item&#39;: {&#39;created_timestamp&#39;: 1658822301,
          &#39;display_name&#39;: &#39;Reef Modeller for eReef&#39;,
          &#39;email&#39;: &#39;John.Doe@uni-of.au&#39;,
          &#39;first_name&#39;: &#39;John&#39;,
          &#39;id&#39;: &#39;10378.1/1687652&#39;,
          &#39;item_category&#39;: &#39;AGENT&#39;,
          &#39;item_subtype&#39;: &#39;PERSON&#39;,
          &#39;last_name&#39;: &#39;Doe&#39;,
          &#39;orcid&#39;: &#39;https://orcid.org/0000-0000-000-0000&#39;,
          &#39;updated_timestamp&#39;: 1658822301},
 &#39;item_is_seed&#39;: False,
 &#39;status&#39;: {&#39;details&#39;: &#39;Successfully retrieved complete item and parsed into &#39;
                       &#39;current data model.&#39;,
            &#39;success&#39;: True}}
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

