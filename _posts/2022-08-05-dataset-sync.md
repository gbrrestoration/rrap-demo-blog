---
keywords: fastai
description: A tutorial of RRAP uploading and downloading dataset using Jupyter notebooks.
title: RRAP-IS Dataset sync Demo Notebook
toc: true 
badges: true
comments: true
categories: [jupyter]
nb_path: _notebooks/2022-08-05-dataset-sync.ipynb
layout: notebook
---

<!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-08-05-dataset-sync.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="About">About<a class="anchor-link" href="#About"> </a></h2><p>This notebook is a demonstration of downloading and uploading dataset to RRAP data repository.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Run-all-imports">Run all imports<a class="anchor-link" href="#Run-all-imports"> </a></h3><p>Keep all your imports at the top of a notebook.  It allows for easier management.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">IFrame</span><span class="p">,</span> <span class="n">display</span><span class="p">,</span> <span class="n">HTML</span><span class="p">,</span> <span class="n">JSON</span><span class="p">,</span> <span class="n">Markdown</span><span class="p">,</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">mdsisclienttools.auth.TokenManager</span> <span class="kn">import</span> <span class="n">DeviceFlowManager</span>
<span class="kn">import</span> <span class="nn">mdsisclienttools.datastore.ReadWriteHelper</span> <span class="k">as</span> <span class="nn">IOHelper</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">cloudpathlib</span> <span class="kn">import</span> <span class="n">S3Client</span>
<span class="kn">import</span> <span class="nn">cloudpathlib</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">&#39;once&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Define-global-variables">Define global variables<a class="anchor-link" href="#Define-global-variables"> </a></h3><p>Similar to import we like to define notebook variable at the top and reuse them throughout the notebook</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data_store</span> <span class="o">=</span> <span class="s2">&quot;https://data.testing.rrap-is.com&quot;</span>
<span class="n">data_api</span> <span class="o">=</span> <span class="s2">&quot;https://data-api.testing.rrap-is.com&quot;</span>
<span class="n">registry_api</span> <span class="o">=</span> <span class="s2">&quot;https://registry-api.testing.rrap-is.com&quot;</span>
<span class="n">prov_api</span> <span class="o">=</span> <span class="s2">&quot;https://prov-api.testing.rrap-is.com&quot;</span>
<span class="n">auth_server</span> <span class="o">=</span> <span class="s2">&quot;https://auth.dev.rrap-is.com/auth/realms/rrap&quot;</span>
<span class="c1"># garbage = &quot;https://frogs.are.green&quot;</span>
<span class="n">base_urls</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;data_api&#39;</span><span class="p">:</span> <span class="n">data_api</span><span class="p">,</span> <span class="s1">&#39;registry_api&#39;</span><span class="p">:</span> <span class="n">registry_api</span><span class="p">,</span> <span class="s1">&#39;prov_api&#39;</span><span class="p">:</span> <span class="n">prov_api</span><span class="p">,</span> <span class="s1">&#39;auth_server&#39;</span><span class="p">:</span> <span class="n">auth_server</span><span class="p">,</span> <span class="s1">&#39;data_store&#39;</span><span class="p">:</span> <span class="n">data_store</span><span class="p">}</span><span class="c1">#, &#39;garbage&#39;: garbage}</span>
<span class="n">display</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Checking base urls&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">base_urls</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Testing - </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="n">r</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; - Passed&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; - Fail&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">SystemExit</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># catastrophic error. bail.</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; - Fail&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">SystemExit</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea ">
<pre>&#39;Checking base urls&#39;</pre>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Testing - https://data-api.testing.rrap-is.com - Passed
Testing - https://registry-api.testing.rrap-is.com - Passed
Testing - https://prov-api.testing.rrap-is.com - Passed
Testing - https://auth.dev.rrap-is.com/auth/realms/rrap - Passed
Testing - https://data.testing.rrap-is.com - Passed
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Authentication">Authentication<a class="anchor-link" href="#Authentication"> </a></h2><h3 id="Setup-tokens-using-device-authorisation-flow-against-keycloak-server">Setup tokens using device authorisation flow against keycloak server<a class="anchor-link" href="#Setup-tokens-using-device-authorisation-flow-against-keycloak-server"> </a></h3><p>This could result in a browser window being opened if you don't have valid tokens cached in local storage.</p>
<p><a href="#toc">Return to Top</a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">local_token_storage</span> <span class="o">=</span> <span class="s2">&quot;.tokens.json&quot;</span>

<span class="n">token_manager</span> <span class="o">=</span> <span class="n">DeviceFlowManager</span><span class="p">(</span>
    <span class="n">stage</span><span class="o">=</span><span class="s2">&quot;TEST&quot;</span><span class="p">,</span>
    <span class="n">keycloak_endpoint</span><span class="o">=</span><span class="n">auth_server</span><span class="p">,</span>
    <span class="n">local_storage_location</span><span class="o">=</span><span class="n">local_token_storage</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Attempting to generate authorisation tokens.

Looking for existing tokens in local storage.

Validating found tokens

Trying to use found tokens to refresh the access token.

Token refresh successful.

</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Endpoint-Documentation">Endpoint Documentation<a class="anchor-link" href="#Endpoint-Documentation"> </a></h2><p>Endpoint documentation can be found by appending either <code>/docs</code> or <code>/redoc</code> on the end a base URL.</p>
<p>For example:</p>
<ul>
  <li><a href="https://data-api.testing.rrap-is.com/redoc" target="_blank">Redoc FastAPI</a></li>
  <li><a href="https://data-api.testing.rrap-is.com/docs" target="_blank">Docs FastAPI</a> </li>
</ul><p>Then select from the menu an endpoint function call e.g. <code>/register/mint-dataset</code></p>
<p>Then append the function call onto the base url e.g. <code>https://data-api.testing.rrap-is.com/register/mint-dataset</code></p>
<p><a href="#toc">Return to Top</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Demonstration">Demonstration<a class="anchor-link" href="#Demonstration"> </a></h2><p>Initially we need to have a registered s3 folder, once this is done we can upload and download datasets to it.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Register-a-dataset">Register a dataset<a class="anchor-link" href="#Register-a-dataset"> </a></h3><p>see <a href="https://gbrrestoration.github.io/rrap-mds-knowledge-hub/information-system/data-store/registering-and-uploading-a-dataset.html">Rigistering and uploading a dataset</a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">auth</span> <span class="o">=</span> <span class="n">token_manager</span><span class="o">.</span><span class="n">get_auth</span>
<span class="n">postfix</span> <span class="o">=</span> <span class="s2">&quot;/register/mint-dataset&quot;</span>
<span class="n">payload</span> <span class="o">=</span>  <span class="p">{</span>
  <span class="s2">&quot;author&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Andrew Freebairn&quot;</span><span class="p">,</span>
    <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="s2">&quot;andrew.freebairn@csiro.au&quot;</span><span class="p">,</span>
    <span class="s2">&quot;orcid&quot;</span><span class="p">:</span> <span class="s2">&quot;https://orcid.org/0000-0001-9429-6559&quot;</span><span class="p">,</span>
    <span class="s2">&quot;organisation&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;CSIRO&quot;</span><span class="p">,</span>
      <span class="s2">&quot;ror&quot;</span><span class="p">:</span> <span class="s2">&quot;https://ror.org/03qn8fb07&quot;</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;dataset_info&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;MVP Demo Dataset&quot;</span><span class="p">,</span>
    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;For demonstration purposes&quot;</span><span class="p">,</span>
    <span class="s2">&quot;publisher&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Andrew&quot;</span><span class="p">,</span>
      <span class="s2">&quot;ror&quot;</span><span class="p">:</span> <span class="s2">&quot;https://ror.org/057xz1h85&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;created_date&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-08-05&quot;</span><span class="p">,</span>
    <span class="s2">&quot;published_date&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-08-05&quot;</span><span class="p">,</span>
    <span class="s2">&quot;license&quot;</span><span class="p">:</span> <span class="s2">&quot;https://creativecommons.org/licenses/by/4.0/&quot;</span><span class="p">,</span>
    <span class="s2">&quot;keywords&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;keyword1&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0.1&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="n">endpoint</span> <span class="o">=</span> <span class="n">data_api</span> <span class="o">+</span> <span class="n">postfix</span> 

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="n">auth</span><span class="p">())</span>
<span class="n">new_handle</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s1">&#39;handle&#39;</span><span class="p">]</span>
<span class="n">display</span><span class="p">(</span><span class="n">new_handle</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">(),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea ">
<pre>&#39;10378.1/1688315&#39;</pre>
</div>

</div>

<div class="output_area">



<div class="output_text output_subarea ">
<pre>&#39;{\n  &#34;status&#34;: {\n    &#34;success&#34;: true,\n    &#34;details&#34;: &#34;Successfully seeded location - see location details.&#34;\n  },\n  &#34;handle&#34;: &#34;10378.1/1688315&#34;,\n  &#34;s3_location&#34;: {\n    &#34;bucket_name&#34;: &#34;dev-rrap-storage-bucket&#34;,\n    &#34;path&#34;: &#34;datasets/10378-1-1688315/&#34;,\n    &#34;s3_uri&#34;: &#34;s3://dev-rrap-storage-bucket/datasets/10378-1-1688315/&#34;\n  }\n}&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">auth</span> <span class="o">=</span> <span class="n">token_manager</span><span class="o">.</span><span class="n">get_auth</span>
<span class="n">postfix</span> <span class="o">=</span> <span class="s2">&quot;/registry/items/list-all-datasets&quot;</span>
<span class="n">endpoint</span> <span class="o">=</span> <span class="n">data_api</span> <span class="o">+</span> <span class="n">postfix</span> 
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="n">auth</span><span class="p">())</span>
<span class="n">reg_items</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s1">&#39;registry_items&#39;</span><span class="p">]</span>
<span class="k">if</span> <span class="nb">any</span><span class="p">(</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;handle&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">new_handle</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">reg_items</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Found new handle: </span><span class="si">{</span><span class="n">new_handle</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Did NOT find new handle: </span><span class="si">{</span><span class="n">new_handle</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Found new handle: 10378.1/1688315
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Upload-data-associated-with-registered-data">Upload data associated with registered data<a class="anchor-link" href="#Upload-data-associated-with-registered-data"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">auth</span> <span class="o">=</span> <span class="n">token_manager</span><span class="o">.</span><span class="n">get_auth</span>
<span class="n">IOHelper</span><span class="o">.</span><span class="n">upload</span><span class="p">(</span><span class="n">new_handle</span><span class="p">,</span> <span class="n">auth</span><span class="p">(),</span> <span class="s2">&quot;./data&quot;</span><span class="p">,</span> <span class="n">data_api</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ValueError</span>                                Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">/home/andrew/repo/rrap-demo-blog/_notebooks/2022-08-05-dataset-sync.ipynb Cell 15</span> in <span class="ansi-cyan-fg">&lt;cell line: 2&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">      &lt;a href=&#39;vscode-notebook-cell://ssh-remote%2Brrap-dev-aws/home/andrew/repo/rrap-demo-blog/_notebooks/2022-08-05-dataset-sync.ipynb#X16sdnNjb2RlLXJlbW90ZQ%3D%3D?line=0&#39;&gt;1&lt;/a&gt;</span> auth = token_manager.get_auth
<span class="ansi-green-fg">----&gt; &lt;a href=&#39;vscode-notebook-cell://ssh-remote%2Brrap-dev-aws/home/andrew/repo/rrap-demo-blog/_notebooks/2022-08-05-dataset-sync.ipynb#X16sdnNjb2RlLXJlbW90ZQ%3D%3D?line=1&#39;&gt;2&lt;/a&gt;</span> IOHelper.upload(new_handle, auth(), &#34;./data&#34;, data_api)

File <span class="ansi-green-fg">~/repo/rrap-demo-blog/.venv_mvp_demo/lib/python3.8/site-packages/mdsisclienttools/datastore/ReadWriteHelper.py:263</span>, in <span class="ansi-cyan-fg">upload</span><span class="ansi-blue-fg">(handle, auth, source_dir, data_store_api_endpoint)</span>
<span class="ansi-green-intense-fg ansi-bold">    260</span>     print(f&#34;Found dataset: {response[&#39;dataset_name&#39;]}.&#34;)
<span class="ansi-green-intense-fg ansi-bold">    261</span> else:
<span class="ansi-green-intense-fg ansi-bold">    262</span>     # Handle was not found
<span class="ansi-green-fg">--&gt; 263</span>     raise ValueError(
<span class="ansi-green-intense-fg ansi-bold">    264</span>         f&#39;Invalid input... the dataset with that handle: {handle} could not be found.&#39;)
<span class="ansi-green-intense-fg ansi-bold">    266</span> # get write credentials for this dataset
<span class="ansi-green-intense-fg ansi-bold">    267</span> creds = _write_dataset(s3_loc, auth=auth, endpoint = data_store_api_endpoint)

<span class="ansi-red-fg">ValueError</span>: Invalid input... the dataset with that handle: 10378.1/1688315 could not be found.</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Download-data-from-a-data-registry">Download data from a data registry<a class="anchor-link" href="#Download-data-from-a-data-registry"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">auth</span> <span class="o">=</span> <span class="n">token_manager</span><span class="o">.</span><span class="n">get_auth</span>
<span class="n">IOHelper</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;./data&#39;</span><span class="p">,</span> <span class="n">new_handle</span><span class="p">,</span> <span class="n">auth</span><span class="p">(),</span> <span class="n">data_api</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ValueError</span>                                Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">/home/andrew/repo/rrap-demo-blog/_notebooks/2022-08-05-dataset-sync.ipynb Cell 17</span> in <span class="ansi-cyan-fg">&lt;cell line: 2&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">      &lt;a href=&#39;vscode-notebook-cell://ssh-remote%2Brrap-dev-aws/home/andrew/repo/rrap-demo-blog/_notebooks/2022-08-05-dataset-sync.ipynb#X21sdnNjb2RlLXJlbW90ZQ%3D%3D?line=0&#39;&gt;1&lt;/a&gt;</span> auth = token_manager.get_auth
<span class="ansi-green-fg">----&gt; &lt;a href=&#39;vscode-notebook-cell://ssh-remote%2Brrap-dev-aws/home/andrew/repo/rrap-demo-blog/_notebooks/2022-08-05-dataset-sync.ipynb#X21sdnNjb2RlLXJlbW90ZQ%3D%3D?line=1&#39;&gt;2&lt;/a&gt;</span> IOHelper.download(&#39;./data&#39;, new_handle, auth(), data_api)

File <span class="ansi-green-fg">~/repo/rrap-demo-blog/.venv_mvp_demo/lib/python3.8/site-packages/mdsisclienttools/datastore/ReadWriteHelper.py:311</span>, in <span class="ansi-cyan-fg">download</span><span class="ansi-blue-fg">(download_path, handle, auth, data_store_api_endpoint)</span>
<span class="ansi-green-intense-fg ansi-bold">    308</span>     print(f&#34;Found dataset: {response[&#39;dataset_name&#39;]}.&#34;)
<span class="ansi-green-intense-fg ansi-bold">    309</span> else:
<span class="ansi-green-intense-fg ansi-bold">    310</span>     # Handle was not found
<span class="ansi-green-fg">--&gt; 311</span>     raise ValueError(
<span class="ansi-green-intense-fg ansi-bold">    312</span>         f&#39;Invalid input... the dataset with that handle: {handle} could not be found.&#39;)
<span class="ansi-green-intense-fg ansi-bold">    314</span> # get read credentials for this dataset
<span class="ansi-green-intense-fg ansi-bold">    315</span> creds = _read_dataset(s3_loc, auth=auth, endpoint = data_store_api_endpoint)

<span class="ansi-red-fg">ValueError</span>: Invalid input... the dataset with that handle: 10378.1/1688315 could not be found.</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

