---
keywords: fastai
description: A tutorial of RRAP authentication using Jupyter notebooks.
title: RRAP-IS Provenance Demo Notebook
toc: true 
badges: true
comments: true
categories: [jupyter]
nb_path: _notebooks/2022-07-20-rrap-provenance-demo.ipynb
layout: notebook
---

<!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-07-20-rrap-provenance-demo.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="About">About<a class="anchor-link" href="#About"> </a></h2><p>This notebook is a demonstration of generating a record of a model run and searching the provenance database to identify linkages between data, models, users and organisations with the RRAP-IS system.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Run-all-imports">Run all imports<a class="anchor-link" href="#Run-all-imports"> </a></h3><p>Keep all your imports at the top of a notebook.  It allows for easier management.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">json2tree</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">IFrame</span><span class="p">,</span> <span class="n">display</span><span class="p">,</span> <span class="n">HTML</span><span class="p">,</span> <span class="n">JSON</span><span class="p">,</span> <span class="n">Markdown</span><span class="p">,</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">mdsisclienttools.auth.TokenManager</span> <span class="kn">import</span> <span class="n">DeviceFlowManager</span>
<span class="kn">from</span> <span class="nn">urllib.error</span> <span class="kn">import</span> <span class="n">HTTPError</span>
<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">import</span> <span class="nn">nx_altair</span> <span class="k">as</span> <span class="nn">nxa</span>
<span class="kn">from</span> <span class="nn">networkx.readwrite</span> <span class="kn">import</span> <span class="n">json_graph</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">holoviews</span> <span class="k">as</span> <span class="nn">hv</span>
<span class="kn">from</span> <span class="nn">holoviews</span> <span class="kn">import</span> <span class="n">opts</span>
<span class="n">hv</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="s1">&#39;bokeh&#39;</span><span class="p">)</span>
<span class="n">defaults</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
<span class="n">hv</span><span class="o">.</span><span class="n">opts</span><span class="o">.</span><span class="n">defaults</span><span class="p">(</span><span class="n">opts</span><span class="o">.</span><span class="n">EdgePaths</span><span class="p">(</span><span class="o">**</span><span class="n">defaults</span><span class="p">),</span> <span class="n">opts</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="o">**</span><span class="n">defaults</span><span class="p">),</span> <span class="n">opts</span><span class="o">.</span><span class="n">Nodes</span><span class="p">(</span><span class="o">**</span><span class="n">defaults</span><span class="p">))</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">&#39;once&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Define-global-variables">Define global variables<a class="anchor-link" href="#Define-global-variables"> </a></h3><p>Similar to import we like to define notebook variable at the top and reuse them throughout the notebook</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data_api</span> <span class="o">=</span> <span class="s2">&quot;https://data-api.testing.rrap-is.com&quot;</span>
<span class="n">registry_api</span> <span class="o">=</span> <span class="s2">&quot;https://registry-api.testing.rrap-is.com&quot;</span>
<span class="n">prov_api</span> <span class="o">=</span> <span class="s2">&quot;https://prov-api.testing.rrap-is.com&quot;</span>
<span class="n">auth_server</span> <span class="o">=</span> <span class="s2">&quot;https://auth.dev.rrap-is.com/auth/realms/rrap&quot;</span>
<span class="c1"># garbage = &quot;https://frogs.are.green&quot;</span>
<span class="n">base_urls</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;data_api&#39;</span><span class="p">:</span> <span class="n">data_api</span><span class="p">,</span> <span class="s1">&#39;registry_api&#39;</span><span class="p">:</span> <span class="n">registry_api</span><span class="p">,</span> <span class="s1">&#39;prov_api&#39;</span><span class="p">:</span> <span class="n">prov_api</span><span class="p">,</span> <span class="s1">&#39;auth_server&#39;</span><span class="p">:</span> <span class="n">auth_server</span><span class="p">}</span><span class="c1">#, &#39;garbage&#39;: garbage}</span>
<span class="n">display</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Checking base urls&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">base_urls</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Testing - </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="n">r</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; - Passed&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; - Fail&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">SystemExit</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># catastrophic error. bail.</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; - Fail&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">SystemExit</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Authentication">Authentication<a class="anchor-link" href="#Authentication"> </a></h2><h3 id="Setup-tokens-using-device-authorisation-flow-against-keycloak-server">Setup tokens using device authorisation flow against keycloak server<a class="anchor-link" href="#Setup-tokens-using-device-authorisation-flow-against-keycloak-server"> </a></h3><p>This could result in a browser window being opened if you don't have valid tokens cached in local storage.</p>
<p><a href="#toc">Return to Top</a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">local_token_storage</span> <span class="o">=</span> <span class="s2">&quot;.tokens.json&quot;</span>

<span class="n">token_manager</span> <span class="o">=</span> <span class="n">DeviceFlowManager</span><span class="p">(</span>
    <span class="n">stage</span><span class="o">=</span><span class="s2">&quot;TEST&quot;</span><span class="p">,</span>
    <span class="n">keycloak_endpoint</span><span class="o">=</span><span class="n">auth_server</span><span class="p">,</span>
    <span class="n">local_storage_location</span><span class="o">=</span><span class="n">local_token_storage</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Helper-functions">Helper functions<a class="anchor-link" href="#Helper-functions"> </a></h2><p><a href="#toc">Return to Top</a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">handle_request</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">params</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="n">auth</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">payload</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="n">auth</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="n">auth</span><span class="p">)</span>
        <span class="c1"># If the response was successful, no Exception will be raised</span>
        <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>

    <span class="k">except</span> <span class="n">HTTPError</span> <span class="k">as</span> <span class="n">http_err</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;HTTP error occurred: </span><span class="si">{</span><span class="n">http_err</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1"># Python 3.6</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="n">http_err</span><span class="p">}</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Other error occurred: </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1"># Python 3.6</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="n">err</span> <span class="p">}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Endpoint-Documentation">Endpoint Documentation<a class="anchor-link" href="#Endpoint-Documentation"> </a></h2><p>Endpoint documentation can be found by appending either <code>/docs</code> or <code>/redoc</code> on the end a base URL.</p>
<p>For example:</p>
<ul>
  <li><a href="https://prov-api.testing.rrap-is.com/redoc" target="_blank">Redoc FastAPI</a></li>
  <li><a href="https://prov-api.testing.rrap-is.com/docs" target="_blank">Docs FastAPI</a> </li>
</ul><p>Then select from the menu an endpoint function call e.g. <code>/explore/lineage</code></p>
<p>Then append the function call onto the base url e.g. <code>https://prov-api.testing.rrap-is.com/explore/lineage</code></p>
<p><a href="#toc">Return to Top</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Demonstration">Demonstration<a class="anchor-link" href="#Demonstration"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Register-a-model-run">Register a model run<a class="anchor-link" href="#Register-a-model-run"> </a></h3><p>A model run consists of six main elements that have already been registered in the RRAP-IS Registry.  These elements are - Workflow definition,</p>
<ul>
<li>Input template,</li>
<li>Output template,</li>
<li>Modeller and</li>
<li>Requesting Organisation</li>
</ul>
<p>see <a href="https://prov-api.testing.rrap-is.com/redoc#tag/Model-Runs/operation/register_model_run_complete_model_run_register_complete_post" target="_blank">Endpoint documentation</a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">auth</span> <span class="o">=</span> <span class="n">token_manager</span><span class="o">.</span><span class="n">get_auth</span>
<span class="n">postfix</span> <span class="o">=</span> <span class="s2">&quot;/model_run/register_complete&quot;</span>
<span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;start_time&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s2">&quot;end_time&quot;</span><span class="p">:</span> <span class="mi">1662467929</span><span class="p">,</span>
  <span class="s2">&quot;workflow_definition&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;10378.1/1691197&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;datasets&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;10378.1/1690478&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;template&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;10378.1/1690478&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;dataset_type&quot;</span><span class="p">:</span> <span class="s2">&quot;DATA_STORE&quot;</span><span class="p">,</span>
        <span class="s2">&quot;dataset&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;10378.1/1688622&quot;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;outputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;datasets&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;10378.1/1690478&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;template&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;10378.1/1690478&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;dataset_type&quot;</span><span class="p">:</span> <span class="s2">&quot;DATA_STORE&quot;</span><span class="p">,</span>
        <span class="s2">&quot;dataset&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;10378.1/1688634&quot;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;associations&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;modeller&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;10378.1/1691160&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;requesting_organisation&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;10378.1/1690557&quot;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="n">endpoint</span> <span class="o">=</span> <span class="n">prov_api</span> <span class="o">+</span> <span class="n">postfix</span> 

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="n">auth</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">(),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{
  &#34;status&#34;: {
    &#34;success&#34;: true,
    &#34;details&#34;: &#34;All successful.&#34;
  },
  &#34;record_info&#34;: {
    &#34;id&#34;: &#34;10378.1/1691231&#34;,
    &#34;prov_json&#34;: &#34;{\&#34;prefix\&#34;: {\&#34;default\&#34;: \&#34;http://hdl.handle.net/\&#34;}, \&#34;activity\&#34;: {\&#34;10378.1/1691231\&#34;: {\&#34;model_run/10378.1/1691231\&#34;: true, \&#34;item_category\&#34;: \&#34;ACTIVITY\&#34;, \&#34;item_subtype\&#34;: \&#34;MODEL_RUN\&#34;}}, \&#34;entity\&#34;: {\&#34;10378.1/1688622\&#34;: {\&#34;model_run/10378.1/1691231\&#34;: true, \&#34;item_category\&#34;: \&#34;ENTITY\&#34;, \&#34;item_subtype\&#34;: \&#34;DATASET\&#34;}, \&#34;10378.1/1688634\&#34;: {\&#34;model_run/10378.1/1691231\&#34;: true, \&#34;item_category\&#34;: \&#34;ENTITY\&#34;, \&#34;item_subtype\&#34;: \&#34;DATASET\&#34;}, \&#34;10378.1/1691197\&#34;: {\&#34;model_run/10378.1/1691231\&#34;: true, \&#34;item_category\&#34;: \&#34;ENTITY\&#34;, \&#34;item_subtype\&#34;: \&#34;MODEL_RUN_WORKFLOW_DEFINITION\&#34;, \&#34;prov:type\&#34;: {\&#34;$\&#34;: \&#34;prov:Collection\&#34;, \&#34;type\&#34;: \&#34;prov:QUALIFIED_NAME\&#34;}}, \&#34;10378.1/1690478\&#34;: {\&#34;model_run/10378.1/1691231\&#34;: true, \&#34;item_category\&#34;: \&#34;ENTITY\&#34;, \&#34;item_subtype\&#34;: \&#34;DATASET_TEMPLATE\&#34;}, \&#34;10378.1/1691116\&#34;: {\&#34;model_run/10378.1/1691231\&#34;: true, \&#34;item_category\&#34;: \&#34;ENTITY\&#34;, \&#34;item_subtype\&#34;: \&#34;MODEL\&#34;}}, \&#34;agent\&#34;: {\&#34;10378.1/1691160\&#34;: {\&#34;model_run/10378.1/1691231\&#34;: true, \&#34;item_category\&#34;: \&#34;AGENT\&#34;, \&#34;item_subtype\&#34;: \&#34;PERSON\&#34;}, \&#34;10378.1/1690557\&#34;: {\&#34;model_run/10378.1/1691231\&#34;: true, \&#34;item_category\&#34;: \&#34;AGENT\&#34;, \&#34;item_subtype\&#34;: \&#34;ORGANISATION\&#34;}}, \&#34;used\&#34;: {\&#34;_:id1\&#34;: {\&#34;prov:activity\&#34;: \&#34;10378.1/1691231\&#34;, \&#34;prov:entity\&#34;: \&#34;10378.1/1688622\&#34;}, \&#34;_:id3\&#34;: {\&#34;prov:activity\&#34;: \&#34;10378.1/1691231\&#34;, \&#34;prov:entity\&#34;: \&#34;10378.1/1691116\&#34;}, \&#34;_:id4\&#34;: {\&#34;prov:activity\&#34;: \&#34;10378.1/1691231\&#34;, \&#34;prov:entity\&#34;: \&#34;10378.1/1691197\&#34;}}, \&#34;wasGeneratedBy\&#34;: {\&#34;_:id2\&#34;: {\&#34;prov:entity\&#34;: \&#34;10378.1/1688634\&#34;, \&#34;prov:activity\&#34;: \&#34;10378.1/1691231\&#34;}}, \&#34;wasAssociatedWith\&#34;: {\&#34;_:id5\&#34;: {\&#34;prov:activity\&#34;: \&#34;10378.1/1691231\&#34;, \&#34;prov:agent\&#34;: \&#34;10378.1/1691160\&#34;}, \&#34;_:id6\&#34;: {\&#34;prov:activity\&#34;: \&#34;10378.1/1691231\&#34;, \&#34;prov:agent\&#34;: \&#34;10378.1/1690557\&#34;}}, \&#34;wasAttributedTo\&#34;: {\&#34;_:id7\&#34;: {\&#34;prov:entity\&#34;: \&#34;10378.1/1688634\&#34;, \&#34;prov:agent\&#34;: \&#34;10378.1/1691160\&#34;}}, \&#34;hadMember\&#34;: {\&#34;_:id8\&#34;: {\&#34;prov:collection\&#34;: \&#34;10378.1/1691197\&#34;, \&#34;prov:entity\&#34;: \&#34;10378.1/1690478\&#34;}, \&#34;_:id11\&#34;: {\&#34;prov:collection\&#34;: \&#34;10378.1/1691197\&#34;, \&#34;prov:entity\&#34;: \&#34;10378.1/1691116\&#34;}}, \&#34;wasInfluencedBy\&#34;: {\&#34;_:id9\&#34;: {\&#34;prov:influencee\&#34;: \&#34;10378.1/1688622\&#34;, \&#34;prov:influencer\&#34;: \&#34;10378.1/1690478\&#34;}, \&#34;_:id10\&#34;: {\&#34;prov:influencee\&#34;: \&#34;10378.1/1688634\&#34;, \&#34;prov:influencer\&#34;: \&#34;10378.1/1690478\&#34;}}}&#34;,
    &#34;record&#34;: {
      &#34;workflow_definition&#34;: {
        &#34;id&#34;: &#34;10378.1/1691197&#34;
      },
      &#34;inputs&#34;: {
        &#34;datasets&#34;: {
          &#34;10378.1/1690478&#34;: {
            &#34;template&#34;: {
              &#34;id&#34;: &#34;10378.1/1690478&#34;
            },
            &#34;dataset_type&#34;: &#34;DATA_STORE&#34;,
            &#34;dataset&#34;: {
              &#34;id&#34;: &#34;10378.1/1688622&#34;
            }
          }
        }
      },
      &#34;outputs&#34;: {
        &#34;datasets&#34;: {
          &#34;10378.1/1690478&#34;: {
            &#34;template&#34;: {
              &#34;id&#34;: &#34;10378.1/1690478&#34;
            },
            &#34;dataset_type&#34;: &#34;DATA_STORE&#34;,
            &#34;dataset&#34;: {
              &#34;id&#34;: &#34;10378.1/1688634&#34;
            }
          }
        }
      },
      &#34;associations&#34;: {
        &#34;modeller&#34;: {
          &#34;id&#34;: &#34;10378.1/1691160&#34;
        },
        &#34;requesting_organisation&#34;: {
          &#34;id&#34;: &#34;10378.1/1690557&#34;
        }
      },
      &#34;start_time&#34;: 0,
      &#34;end_time&#34;: 1662467929
    }
  }
}
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Explore-lineage">Explore lineage<a class="anchor-link" href="#Explore-lineage"> </a></h3><p><a href="#toc">Return to Top</a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">auth</span> <span class="o">=</span> <span class="n">token_manager</span><span class="o">.</span><span class="n">get_auth</span>
<span class="n">postfix</span> <span class="o">=</span> <span class="s2">&quot;/explore/upstream&quot;</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;starting_id&quot;</span><span class="p">:</span> <span class="s2">&quot;10378.1/1691200&quot;</span><span class="p">,</span>
    <span class="s2">&quot;depth&quot;</span><span class="p">:</span> <span class="mi">10</span>
<span class="p">}</span>
<span class="n">endpoint</span> <span class="o">=</span> <span class="n">prov_api</span> <span class="o">+</span> <span class="n">postfix</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="n">auth</span><span class="p">())</span>

<span class="n">result_graph</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;graph&quot;</span><span class="p">]</span>

<span class="n">a_graph</span> <span class="o">=</span> <span class="n">json_graph</span><span class="o">.</span><span class="n">node_link_graph</span><span class="p">(</span><span class="n">result_graph</span><span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">hv</span><span class="o">.</span><span class="n">Graph</span><span class="o">.</span><span class="n">from_networkx</span><span class="p">(</span><span class="n">a_graph</span><span class="p">,</span> <span class="n">nx</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">fruchterman_reingold_layout</span><span class="p">)</span><span class="c1">#.opts(tools=[&#39;hover&#39;])</span>

<span class="n">hv</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="s1">&#39;lineage_network.html&#39;</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">&#39;bokeh&#39;</span><span class="p">)</span>

<span class="n">HTML</span><span class="p">(</span><span class="s1">&#39;lineage_network.html&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">


<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="utf-8">
      <title>lineage_network</title>
              <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.css" type="text/css" />
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" type="text/css" />
            <link rel="stylesheet" href="https://unpkg.com/@holoviz/panel@0.13.1/dist/css/loading.css" type="text/css" />
            <link rel="stylesheet" href="https://unpkg.com/@holoviz/panel@0.13.1/dist/css/debugger.css" type="text/css" />
            <link rel="stylesheet" href="https://unpkg.com/@holoviz/panel@0.13.1/dist/css/json.css" type="text/css" />
            <link rel="stylesheet" href="https://unpkg.com/@holoviz/panel@0.13.1/dist/css/alerts.css" type="text/css" />
            <link rel="stylesheet" href="https://unpkg.com/@holoviz/panel@0.13.1/dist/css/dataframe.css" type="text/css" />
            <link rel="stylesheet" href="https://unpkg.com/@holoviz/panel@0.13.1/dist/css/card.css" type="text/css" />
            <link rel="stylesheet" href="https://unpkg.com/@holoviz/panel@0.13.1/dist/css/widgets.css" type="text/css" />
            <link rel="stylesheet" href="https://unpkg.com/@holoviz/panel@0.13.1/dist/css/markdown.css" type="text/css" />
            <style>
                
            .bk.pn-loading.arcs:before {
              background-image: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBzdHlsZT0ibWFyZ2luOiBhdXRvOyBiYWNrZ3JvdW5kOiBub25lOyBkaXNwbGF5OiBibG9jazsgc2hhcGUtcmVuZGVyaW5nOiBhdXRvOyIgdmlld0JveD0iMCAwIDEwMCAxMDAiIHByZXNlcnZlQXNwZWN0UmF0aW89InhNaWRZTWlkIj4gIDxjaXJjbGUgY3g9IjUwIiBjeT0iNTAiIHI9IjMyIiBzdHJva2Utd2lkdGg9IjgiIHN0cm9rZT0iI2MzYzNjMyIgc3Ryb2tlLWRhc2hhcnJheT0iNTAuMjY1NDgyNDU3NDM2NjkgNTAuMjY1NDgyNDU3NDM2NjkiIGZpbGw9Im5vbmUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCI+ICAgIDxhbmltYXRlVHJhbnNmb3JtIGF0dHJpYnV0ZU5hbWU9InRyYW5zZm9ybSIgdHlwZT0icm90YXRlIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIgZHVyPSIxcyIga2V5VGltZXM9IjA7MSIgdmFsdWVzPSIwIDUwIDUwOzM2MCA1MCA1MCI+PC9hbmltYXRlVHJhbnNmb3JtPiAgPC9jaXJjbGU+PC9zdmc+");
              background-size: auto calc(min(50%, 400px));
            }
            
            </style>

          <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-2.4.3.min.js"></script><script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-gl-2.4.3.min.js"></script><script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-widgets-2.4.3.min.js"></script><script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-tables-2.4.3.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.js"></script><script type="text/javascript" src="https://unpkg.com/@holoviz/panel@0.13.1/dist/panel.min.js"></script><script type="text/javascript">
            Bokeh.set_log_level("info");
        </script>
  </head>
  <body>
          
              <div class="bk-root" id="3740f17e-f602-4028-aceb-9b62d6eded22" data-root-id="2268"></div>
      
        <script type="application/json" id="2449">
          {"48bd927b-ccc5-4369-ab93-d27ee9a7c4a7":{"defs":[{"extends":null,"module":null,"name":"ReactiveHTML1","overrides":[],"properties":[]},{"extends":null,"module":null,"name":"FlexBox1","overrides":[],"properties":[{"default":"flex-start","kind":null,"name":"align_content"},{"default":"flex-start","kind":null,"name":"align_items"},{"default":"row","kind":null,"name":"flex_direction"},{"default":"wrap","kind":null,"name":"flex_wrap"},{"default":"flex-start","kind":null,"name":"justify_content"}]},{"extends":null,"module":null,"name":"GridStack1","overrides":[],"properties":[{"default":"warn","kind":null,"name":"mode"},{"default":null,"kind":null,"name":"ncols"},{"default":null,"kind":null,"name":"nrows"},{"default":true,"kind":null,"name":"allow_resize"},{"default":true,"kind":null,"name":"allow_drag"},{"default":[],"kind":null,"name":"state"}]},{"extends":null,"module":null,"name":"click1","overrides":[],"properties":[{"default":"","kind":null,"name":"terminal_output"},{"default":"","kind":null,"name":"debug_name"},{"default":0,"kind":null,"name":"clears"}]},{"extends":null,"module":null,"name":"NotificationAreaBase1","overrides":[],"properties":[{"default":"bottom-right","kind":null,"name":"position"},{"default":0,"kind":null,"name":"_clear"}]},{"extends":null,"module":null,"name":"NotificationArea1","overrides":[],"properties":[{"default":[],"kind":null,"name":"notifications"},{"default":"bottom-right","kind":null,"name":"position"},{"default":0,"kind":null,"name":"_clear"},{"default":[{"background":"#ffc107","icon":{"className":"fas fa-exclamation-triangle","color":"white","tagName":"i"},"type":"warning"},{"background":"#007bff","icon":{"className":"fas fa-info-circle","color":"white","tagName":"i"},"type":"info"}],"kind":null,"name":"types"}]},{"extends":null,"module":null,"name":"Notification","overrides":[],"properties":[{"default":null,"kind":null,"name":"background"},{"default":3000,"kind":null,"name":"duration"},{"default":null,"kind":null,"name":"icon"},{"default":"","kind":null,"name":"message"},{"default":null,"kind":null,"name":"notification_type"},{"default":false,"kind":null,"name":"_destroyed"}]},{"extends":null,"module":null,"name":"TemplateActions1","overrides":[],"properties":[{"default":0,"kind":null,"name":"open_modal"},{"default":0,"kind":null,"name":"close_modal"}]},{"extends":null,"module":null,"name":"MaterialTemplateActions1","overrides":[],"properties":[{"default":0,"kind":null,"name":"open_modal"},{"default":0,"kind":null,"name":"close_modal"}]}],"roots":{"references":[{"attributes":{"data":{"index":{"__ndarray__":"AAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAA==","dtype":"int32","order":"little","shape":[7]},"index_hover":["10378.1/1688622","10378.1/1690478","10378.1/1690557","10378.1/1691116","10378.1/1691160","10378.1/1691197","10378.1/1691200"],"item_category":["ENTITY","ENTITY","AGENT","ENTITY","AGENT","ENTITY","ACTIVITY"],"item_subtype":["DATASET","DATASET_TEMPLATE","ORGANISATION","MODEL","PERSON","MODEL_RUN_WORKFLOW_DEFINITION","MODEL_RUN"]},"selected":{"id":"2348"},"selection_policy":{"id":"2347"}},"id":"2305","type":"ColumnDataSource"},{"attributes":{"coordinates":null,"edge_renderer":{"id":"2318"},"group":null,"inspection_policy":{"id":"2331"},"layout_provider":{"id":"2307"},"node_renderer":{"id":"2312"},"selection_policy":{"id":"2329"}},"id":"2320","type":"GraphRenderer"},{"attributes":{"end":0.922417673292474,"reset_end":0.922417673292474,"reset_start":-1.1747652430265885,"start":-1.1747652430265885,"tags":[[["y","y",null]]]},"id":"2271","type":"Range1d"},{"attributes":{},"id":"2338","type":"AllLabels"},{"attributes":{},"id":"2287","type":"BasicTicker"},{"attributes":{},"id":"2334","type":"BasicTickFormatter"},{"attributes":{},"id":"2292","type":"WheelZoomTool"},{"attributes":{"fill_color":{"value":"#30a2da"},"hatch_color":{"value":"#30a2da"},"size":{"value":15}},"id":"2308","type":"Circle"},{"attributes":{"graph_layout":{"0":[0.376494731991228,0.6255537387278673],"1":[0.7040462641551051,0.7476524302658855],"2":[-0.8637697026115693,-0.5978438921357272],"3":[0.2235457120367536,-1.0],"4":[-0.776376672096717,0.4849003668235205],"5":[0.4767331991875361,-0.131164294631821],"6":[-0.14067353266233643,-0.12909834904972534]}},"id":"2307","type":"StaticLayoutProvider"},{"attributes":{"callback":null,"renderers":[{"id":"2320"}],"tags":["hv_created"],"tooltips":[["index","@{index_hover}"],["item_category","@{item_category}"],["item_subtype","@{item_subtype}"]]},"id":"2272","type":"HoverTool"},{"attributes":{"margin":[5,5,5,5],"name":"HSpacer01965","sizing_mode":"stretch_width"},"id":"2351","type":"Spacer"},{"attributes":{},"id":"2290","type":"SaveTool"},{"attributes":{},"id":"2337","type":"BasicTickFormatter"},{"attributes":{"overlay":{"id":"2296"}},"id":"2293","type":"BoxZoomTool"},{"attributes":{},"id":"2294","type":"ResetTool"},{"attributes":{"coordinates":null,"data_source":{"id":"2305"},"glyph":{"id":"2308"},"group":null,"hover_glyph":{"id":"2310"},"muted_glyph":{"id":"2311"},"nonselection_glyph":{"id":"2309"},"view":{"id":"2313"}},"id":"2312","type":"GlyphRenderer"},{"attributes":{"callback":null},"id":"2295","type":"TapTool"},{"attributes":{"margin":[5,5,5,5],"name":"HSpacer01964","sizing_mode":"stretch_width"},"id":"2269","type":"Spacer"},{"attributes":{"fill_color":{"value":"limegreen"},"hatch_color":{"value":"#30a2da"},"size":{"value":15}},"id":"2310","type":"Circle"},{"attributes":{"bottom_units":"screen","coordinates":null,"fill_alpha":0.5,"fill_color":"lightgrey","group":null,"left_units":"screen","level":"overlay","line_alpha":1.0,"line_color":"black","line_dash":[4,4],"line_width":2,"right_units":"screen","syncable":false,"top_units":"screen"},"id":"2296","type":"BoxAnnotation"},{"attributes":{},"id":"2347","type":"UnionRenderers"},{"attributes":{},"id":"2350","type":"Selection"},{"attributes":{"data":{"end":{"__ndarray__":"AAAAAAMAAAAFAAAABAAAAAIAAAABAAAAAQAAAAMAAAA=","dtype":"int32","order":"little","shape":[8]},"start":{"__ndarray__":"BgAAAAYAAAAGAAAABgAAAAYAAAAAAAAABQAAAAUAAAA=","dtype":"int32","order":"little","shape":[8]}},"selected":{"id":"2350"},"selection_policy":{"id":"2349"}},"id":"2306","type":"ColumnDataSource"},{"attributes":{"tools":[{"id":"2272"},{"id":"2290"},{"id":"2291"},{"id":"2292"},{"id":"2293"},{"id":"2294"},{"id":"2295"}]},"id":"2297","type":"Toolbar"},{"attributes":{},"id":"2348","type":"Selection"},{"attributes":{"fill_alpha":{"value":0.2},"fill_color":{"value":"#30a2da"},"hatch_alpha":{"value":0.2},"hatch_color":{"value":"#30a2da"},"line_alpha":{"value":0.2},"size":{"value":15}},"id":"2311","type":"Circle"},{"attributes":{"source":{"id":"2305"}},"id":"2313","type":"CDSView"},{"attributes":{"line_width":{"value":2}},"id":"2314","type":"MultiLine"},{"attributes":{},"id":"2283","type":"BasicTicker"},{"attributes":{"axis":{"id":"2282"},"coordinates":null,"grid_line_color":null,"group":null,"ticker":null},"id":"2285","type":"Grid"},{"attributes":{"fill_alpha":{"value":0.2},"fill_color":{"value":"#30a2da"},"hatch_alpha":{"value":0.2},"hatch_color":{"value":"#30a2da"},"line_alpha":{"value":0.2},"size":{"value":15}},"id":"2309","type":"Circle"},{"attributes":{"line_alpha":{"value":0.2},"line_width":{"value":2}},"id":"2317","type":"MultiLine"},{"attributes":{},"id":"2349","type":"UnionRenderers"},{"attributes":{"coordinates":null,"group":null,"text_color":"black","text_font_size":"12pt"},"id":"2274","type":"Title"},{"attributes":{"source":{"id":"2306"}},"id":"2319","type":"CDSView"},{"attributes":{"children":[{"id":"2269"},{"id":"2273"},{"id":"2351"}],"margin":[0,0,0,0],"name":"Row01960","tags":["embedded"]},"id":"2268","type":"Row"},{"attributes":{"axis_label":"x","coordinates":null,"formatter":{"id":"2334"},"group":null,"major_label_policy":{"id":"2335"},"ticker":{"id":"2283"}},"id":"2282","type":"LinearAxis"},{"attributes":{"line_color":{"value":"limegreen"},"line_width":{"value":2}},"id":"2316","type":"MultiLine"},{"attributes":{"line_alpha":{"value":0.2},"line_width":{"value":2}},"id":"2315","type":"MultiLine"},{"attributes":{"coordinates":null,"data_source":{"id":"2306"},"glyph":{"id":"2314"},"group":null,"hover_glyph":{"id":"2316"},"muted_glyph":{"id":"2317"},"nonselection_glyph":{"id":"2315"},"view":{"id":"2319"}},"id":"2318","type":"GlyphRenderer"},{"attributes":{"axis":{"id":"2286"},"coordinates":null,"dimension":1,"grid_line_color":null,"group":null,"ticker":null},"id":"2289","type":"Grid"},{"attributes":{},"id":"2329","type":"NodesAndLinkedEdges"},{"attributes":{},"id":"2278","type":"LinearScale"},{"attributes":{},"id":"2280","type":"LinearScale"},{"attributes":{},"id":"2335","type":"AllLabels"},{"attributes":{"below":[{"id":"2282"}],"center":[{"id":"2285"},{"id":"2289"}],"left":[{"id":"2286"}],"margin":[5,5,5,5],"min_border_bottom":10,"min_border_left":10,"min_border_right":10,"min_border_top":10,"renderers":[{"id":"2320"}],"sizing_mode":"fixed","title":{"id":"2274"},"toolbar":{"id":"2297"},"width":800,"x_range":{"id":"2270"},"x_scale":{"id":"2278"},"y_range":{"id":"2271"},"y_scale":{"id":"2280"}},"id":"2273","subtype":"Figure","type":"Plot"},{"attributes":{},"id":"2331","type":"NodesAndLinkedEdges"},{"attributes":{"end":0.8216324616626056,"reset_end":0.8216324616626056,"reset_start":-0.9813559001190698,"start":-0.9813559001190698,"tags":[[["x","x",null]]]},"id":"2270","type":"Range1d"},{"attributes":{"axis_label":"y","coordinates":null,"formatter":{"id":"2337"},"group":null,"major_label_policy":{"id":"2338"},"ticker":{"id":"2287"}},"id":"2286","type":"LinearAxis"},{"attributes":{},"id":"2291","type":"PanTool"}],"root_ids":["2268"]},"title":"Bokeh Application","version":"2.4.3"}}
        </script>
        <script type="text/javascript">
          (function() {
            const fn = function() {
              Bokeh.safely(function() {
                (function(root) {
                  function embed_document(root) {
                  const docs_json = document.getElementById('2449').textContent;
                  const render_items = [{"docid":"48bd927b-ccc5-4369-ab93-d27ee9a7c4a7","root_ids":["2268"],"roots":{"2268":"3740f17e-f602-4028-aceb-9b62d6eded22"}}];
                  root.Bokeh.embed.embed_items(docs_json, render_items);
                  }
                  if (root.Bokeh !== undefined) {
                    embed_document(root);
                  } else {
                    let attempts = 0;
                    const timer = setInterval(function(root) {
                      if (root.Bokeh !== undefined) {
                        clearInterval(timer);
                        embed_document(root);
                      } else {
                        attempts++;
                        if (attempts > 100) {
                          clearInterval(timer);
                          console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
                        }
                      }
                    }, 10, root)
                  }
                })(window);
              });
            };
            if (document.readyState != "loading") fn();
            else document.addEventListener("DOMContentLoaded", fn);
          })();
        </script>
  </body>
</html>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Explore-Children">Explore Children<a class="anchor-link" href="#Explore-Children"> </a></h3><p><a href="#toc">Return to Top</a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">auth</span> <span class="o">=</span> <span class="n">token_manager</span><span class="o">.</span><span class="n">get_auth</span>
<span class="n">postfix</span> <span class="o">=</span> <span class="s2">&quot;/explore/downstream&quot;</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;starting_id&quot;</span><span class="p">:</span> <span class="s2">&quot;10378.1/1691200&quot;</span>
<span class="p">}</span>
<span class="n">endpoint</span> <span class="o">=</span> <span class="n">prov_api</span> <span class="o">+</span> <span class="n">postfix</span> 

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="n">auth</span><span class="p">())</span>

<span class="n">result_graph</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;graph&quot;</span><span class="p">]</span>

<span class="n">a_graph</span> <span class="o">=</span> <span class="n">json_graph</span><span class="o">.</span><span class="n">node_link_graph</span><span class="p">(</span><span class="n">result_graph</span><span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">hv</span><span class="o">.</span><span class="n">Graph</span><span class="o">.</span><span class="n">from_networkx</span><span class="p">(</span><span class="n">a_graph</span><span class="p">,</span> <span class="n">nx</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">fruchterman_reingold_layout</span><span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span><span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;hover&#39;</span><span class="p">])</span>

<span class="n">hv</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="s1">&#39;network.html&#39;</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">&#39;bokeh&#39;</span><span class="p">)</span>

<span class="n">HTML</span><span class="p">(</span><span class="s2">&quot;network.html&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">


<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="utf-8">
      <title>network</title>
              <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.css" type="text/css" />
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" type="text/css" />
            <link rel="stylesheet" href="https://unpkg.com/@holoviz/panel@0.13.1/dist/css/loading.css" type="text/css" />
            <link rel="stylesheet" href="https://unpkg.com/@holoviz/panel@0.13.1/dist/css/debugger.css" type="text/css" />
            <link rel="stylesheet" href="https://unpkg.com/@holoviz/panel@0.13.1/dist/css/json.css" type="text/css" />
            <link rel="stylesheet" href="https://unpkg.com/@holoviz/panel@0.13.1/dist/css/alerts.css" type="text/css" />
            <link rel="stylesheet" href="https://unpkg.com/@holoviz/panel@0.13.1/dist/css/dataframe.css" type="text/css" />
            <link rel="stylesheet" href="https://unpkg.com/@holoviz/panel@0.13.1/dist/css/card.css" type="text/css" />
            <link rel="stylesheet" href="https://unpkg.com/@holoviz/panel@0.13.1/dist/css/widgets.css" type="text/css" />
            <link rel="stylesheet" href="https://unpkg.com/@holoviz/panel@0.13.1/dist/css/markdown.css" type="text/css" />
            <style>
                
            .bk.pn-loading.arcs:before {
              background-image: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBzdHlsZT0ibWFyZ2luOiBhdXRvOyBiYWNrZ3JvdW5kOiBub25lOyBkaXNwbGF5OiBibG9jazsgc2hhcGUtcmVuZGVyaW5nOiBhdXRvOyIgdmlld0JveD0iMCAwIDEwMCAxMDAiIHByZXNlcnZlQXNwZWN0UmF0aW89InhNaWRZTWlkIj4gIDxjaXJjbGUgY3g9IjUwIiBjeT0iNTAiIHI9IjMyIiBzdHJva2Utd2lkdGg9IjgiIHN0cm9rZT0iI2MzYzNjMyIgc3Ryb2tlLWRhc2hhcnJheT0iNTAuMjY1NDgyNDU3NDM2NjkgNTAuMjY1NDgyNDU3NDM2NjkiIGZpbGw9Im5vbmUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCI+ICAgIDxhbmltYXRlVHJhbnNmb3JtIGF0dHJpYnV0ZU5hbWU9InRyYW5zZm9ybSIgdHlwZT0icm90YXRlIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIgZHVyPSIxcyIga2V5VGltZXM9IjA7MSIgdmFsdWVzPSIwIDUwIDUwOzM2MCA1MCA1MCI+PC9hbmltYXRlVHJhbnNmb3JtPiAgPC9jaXJjbGU+PC9zdmc+");
              background-size: auto calc(min(50%, 400px));
            }
            
            </style>

          <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-2.4.3.min.js"></script><script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-gl-2.4.3.min.js"></script><script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-widgets-2.4.3.min.js"></script><script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-tables-2.4.3.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.js"></script><script type="text/javascript" src="https://unpkg.com/@holoviz/panel@0.13.1/dist/panel.min.js"></script><script type="text/javascript">
            Bokeh.set_log_level("info");
        </script>
  </head>
  <body>
          
              <div class="bk-root" id="6c630a87-c90d-4057-b7ef-902bf689caeb" data-root-id="2450"></div>
      
        <script type="application/json" id="2629">
          {"6f9901f1-83ae-4042-883a-f4367d179a2c":{"defs":[{"extends":null,"module":null,"name":"ReactiveHTML1","overrides":[],"properties":[]},{"extends":null,"module":null,"name":"FlexBox1","overrides":[],"properties":[{"default":"flex-start","kind":null,"name":"align_content"},{"default":"flex-start","kind":null,"name":"align_items"},{"default":"row","kind":null,"name":"flex_direction"},{"default":"wrap","kind":null,"name":"flex_wrap"},{"default":"flex-start","kind":null,"name":"justify_content"}]},{"extends":null,"module":null,"name":"GridStack1","overrides":[],"properties":[{"default":"warn","kind":null,"name":"mode"},{"default":null,"kind":null,"name":"ncols"},{"default":null,"kind":null,"name":"nrows"},{"default":true,"kind":null,"name":"allow_resize"},{"default":true,"kind":null,"name":"allow_drag"},{"default":[],"kind":null,"name":"state"}]},{"extends":null,"module":null,"name":"click1","overrides":[],"properties":[{"default":"","kind":null,"name":"terminal_output"},{"default":"","kind":null,"name":"debug_name"},{"default":0,"kind":null,"name":"clears"}]},{"extends":null,"module":null,"name":"NotificationAreaBase1","overrides":[],"properties":[{"default":"bottom-right","kind":null,"name":"position"},{"default":0,"kind":null,"name":"_clear"}]},{"extends":null,"module":null,"name":"NotificationArea1","overrides":[],"properties":[{"default":[],"kind":null,"name":"notifications"},{"default":"bottom-right","kind":null,"name":"position"},{"default":0,"kind":null,"name":"_clear"},{"default":[{"background":"#ffc107","icon":{"className":"fas fa-exclamation-triangle","color":"white","tagName":"i"},"type":"warning"},{"background":"#007bff","icon":{"className":"fas fa-info-circle","color":"white","tagName":"i"},"type":"info"}],"kind":null,"name":"types"}]},{"extends":null,"module":null,"name":"Notification","overrides":[],"properties":[{"default":null,"kind":null,"name":"background"},{"default":3000,"kind":null,"name":"duration"},{"default":null,"kind":null,"name":"icon"},{"default":"","kind":null,"name":"message"},{"default":null,"kind":null,"name":"notification_type"},{"default":false,"kind":null,"name":"_destroyed"}]},{"extends":null,"module":null,"name":"TemplateActions1","overrides":[],"properties":[{"default":0,"kind":null,"name":"open_modal"},{"default":0,"kind":null,"name":"close_modal"}]},{"extends":null,"module":null,"name":"MaterialTemplateActions1","overrides":[],"properties":[{"default":0,"kind":null,"name":"open_modal"},{"default":0,"kind":null,"name":"close_modal"}]}],"roots":{"references":[{"attributes":{},"id":"2527","type":"UnionRenderers"},{"attributes":{},"id":"2509","type":"NodesAndLinkedEdges"},{"attributes":{},"id":"2528","type":"Selection"},{"attributes":{"axis":{"id":"2464"},"coordinates":null,"grid_line_color":null,"group":null,"ticker":null},"id":"2467","type":"Grid"},{"attributes":{"below":[{"id":"2464"}],"center":[{"id":"2467"},{"id":"2471"}],"left":[{"id":"2468"}],"margin":[5,5,5,5],"min_border_bottom":10,"min_border_left":10,"min_border_right":10,"min_border_top":10,"renderers":[{"id":"2500"}],"sizing_mode":"fixed","title":{"id":"2456"},"toolbar":{"id":"2478"},"width":800,"x_range":{"id":"2452"},"x_scale":{"id":"2460"},"y_range":{"id":"2453"},"y_scale":{"id":"2462"}},"id":"2455","subtype":"Figure","type":"Plot"},{"attributes":{},"id":"2529","type":"UnionRenderers"},{"attributes":{},"id":"2462","type":"LinearScale"},{"attributes":{},"id":"2515","type":"AllLabels"},{"attributes":{},"id":"2460","type":"LinearScale"},{"attributes":{},"id":"2511","type":"NodesAndLinkedEdges"},{"attributes":{"coordinates":null,"group":null,"text_color":"black","text_font_size":"12pt"},"id":"2456","type":"Title"},{"attributes":{"callback":null,"renderers":[{"id":"2500"}],"tags":["hv_created"],"tooltips":[["index","@{index_hover}"],["item_category","@{item_category}"],["item_subtype","@{item_subtype}"]]},"id":"2454","type":"HoverTool"},{"attributes":{"margin":[5,5,5,5],"name":"HSpacer02055","sizing_mode":"stretch_width"},"id":"2451","type":"Spacer"},{"attributes":{},"id":"2514","type":"BasicTickFormatter"},{"attributes":{},"id":"2517","type":"BasicTickFormatter"},{"attributes":{"end":1.2,"reset_end":1.2,"reset_start":-1.2,"start":-1.2,"tags":[[["y","y",null]]]},"id":"2453","type":"Range1d"},{"attributes":{},"id":"2518","type":"AllLabels"},{"attributes":{"axis_label":"x","coordinates":null,"formatter":{"id":"2514"},"group":null,"major_label_policy":{"id":"2515"},"ticker":{"id":"2465"}},"id":"2464","type":"LinearAxis"},{"attributes":{},"id":"2465","type":"BasicTicker"},{"attributes":{"fill_color":{"value":"#30a2da"},"hatch_color":{"value":"#30a2da"},"size":{"value":15}},"id":"2488","type":"Circle"},{"attributes":{"end":0.37048072977777724,"reset_end":0.37048072977777724,"reset_start":-0.3704807297777774,"start":-0.3704807297777774,"tags":[[["x","x",null]]]},"id":"2452","type":"Range1d"},{"attributes":{"tools":[{"id":"2454"},{"id":"2472"},{"id":"2473"},{"id":"2474"},{"id":"2475"},{"id":"2476"}]},"id":"2478","type":"Toolbar"},{"attributes":{},"id":"2473","type":"PanTool"},{"attributes":{"graph_layout":{"0":[0.32215715632850195,1.0],"1":[-0.3221571563285021,-0.9999999999999999]}},"id":"2487","type":"StaticLayoutProvider"},{"attributes":{"margin":[5,5,5,5],"name":"HSpacer02056","sizing_mode":"stretch_width"},"id":"2531","type":"Spacer"},{"attributes":{"coordinates":null,"edge_renderer":{"id":"2498"},"group":null,"inspection_policy":{"id":"2511"},"layout_provider":{"id":"2487"},"node_renderer":{"id":"2492"},"selection_policy":{"id":"2509"}},"id":"2500","type":"GraphRenderer"},{"attributes":{"axis_label":"y","coordinates":null,"formatter":{"id":"2517"},"group":null,"major_label_policy":{"id":"2518"},"ticker":{"id":"2469"}},"id":"2468","type":"LinearAxis"},{"attributes":{"axis":{"id":"2468"},"coordinates":null,"dimension":1,"grid_line_color":null,"group":null,"ticker":null},"id":"2471","type":"Grid"},{"attributes":{},"id":"2469","type":"BasicTicker"},{"attributes":{},"id":"2530","type":"Selection"},{"attributes":{},"id":"2474","type":"WheelZoomTool"},{"attributes":{"data":{"index":{"__ndarray__":"AAAAAAEAAAA=","dtype":"int32","order":"little","shape":[2]},"index_hover":["10378.1/1688634","10378.1/1691200"],"item_category":["ENTITY","ACTIVITY"],"item_subtype":["DATASET","MODEL_RUN"]},"selected":{"id":"2528"},"selection_policy":{"id":"2527"}},"id":"2485","type":"ColumnDataSource"},{"attributes":{"fill_color":{"value":"limegreen"},"hatch_color":{"value":"#30a2da"},"size":{"value":15}},"id":"2490","type":"Circle"},{"attributes":{},"id":"2472","type":"SaveTool"},{"attributes":{"line_alpha":{"value":0.2},"line_width":{"value":2}},"id":"2495","type":"MultiLine"},{"attributes":{"data":{"end":{"__ndarray__":"AQAAAA==","dtype":"int32","order":"little","shape":[1]},"start":{"__ndarray__":"AAAAAA==","dtype":"int32","order":"little","shape":[1]}},"selected":{"id":"2530"},"selection_policy":{"id":"2529"}},"id":"2486","type":"ColumnDataSource"},{"attributes":{"overlay":{"id":"2477"}},"id":"2475","type":"BoxZoomTool"},{"attributes":{"fill_alpha":{"value":0.2},"fill_color":{"value":"#30a2da"},"hatch_alpha":{"value":0.2},"hatch_color":{"value":"#30a2da"},"line_alpha":{"value":0.2},"size":{"value":15}},"id":"2491","type":"Circle"},{"attributes":{},"id":"2476","type":"ResetTool"},{"attributes":{"source":{"id":"2485"}},"id":"2493","type":"CDSView"},{"attributes":{"line_alpha":{"value":0.2},"line_width":{"value":2}},"id":"2497","type":"MultiLine"},{"attributes":{"line_width":{"value":2}},"id":"2494","type":"MultiLine"},{"attributes":{"bottom_units":"screen","coordinates":null,"fill_alpha":0.5,"fill_color":"lightgrey","group":null,"left_units":"screen","level":"overlay","line_alpha":1.0,"line_color":"black","line_dash":[4,4],"line_width":2,"right_units":"screen","syncable":false,"top_units":"screen"},"id":"2477","type":"BoxAnnotation"},{"attributes":{"fill_alpha":{"value":0.2},"fill_color":{"value":"#30a2da"},"hatch_alpha":{"value":0.2},"hatch_color":{"value":"#30a2da"},"line_alpha":{"value":0.2},"size":{"value":15}},"id":"2489","type":"Circle"},{"attributes":{"source":{"id":"2486"}},"id":"2499","type":"CDSView"},{"attributes":{"coordinates":null,"data_source":{"id":"2485"},"glyph":{"id":"2488"},"group":null,"hover_glyph":{"id":"2490"},"muted_glyph":{"id":"2491"},"nonselection_glyph":{"id":"2489"},"view":{"id":"2493"}},"id":"2492","type":"GlyphRenderer"},{"attributes":{"children":[{"id":"2451"},{"id":"2455"},{"id":"2531"}],"margin":[0,0,0,0],"name":"Row02051","tags":["embedded"]},"id":"2450","type":"Row"},{"attributes":{"line_color":{"value":"limegreen"},"line_width":{"value":2}},"id":"2496","type":"MultiLine"},{"attributes":{"coordinates":null,"data_source":{"id":"2486"},"glyph":{"id":"2494"},"group":null,"hover_glyph":{"id":"2496"},"muted_glyph":{"id":"2497"},"nonselection_glyph":{"id":"2495"},"view":{"id":"2499"}},"id":"2498","type":"GlyphRenderer"}],"root_ids":["2450"]},"title":"Bokeh Application","version":"2.4.3"}}
        </script>
        <script type="text/javascript">
          (function() {
            const fn = function() {
              Bokeh.safely(function() {
                (function(root) {
                  function embed_document(root) {
                  const docs_json = document.getElementById('2629').textContent;
                  const render_items = [{"docid":"6f9901f1-83ae-4042-883a-f4367d179a2c","root_ids":["2450"],"roots":{"2450":"6c630a87-c90d-4057-b7ef-902bf689caeb"}}];
                  root.Bokeh.embed.embed_items(docs_json, render_items);
                  }
                  if (root.Bokeh !== undefined) {
                    embed_document(root);
                  } else {
                    let attempts = 0;
                    const timer = setInterval(function(root) {
                      if (root.Bokeh !== undefined) {
                        clearInterval(timer);
                        embed_document(root);
                      } else {
                        attempts++;
                        if (attempts > 100) {
                          clearInterval(timer);
                          console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
                        }
                      }
                    }, 10, root)
                  }
                })(window);
              });
            };
            if (document.readyState != "loading") fn();
            else document.addEventListener("DOMContentLoaded", fn);
          })();
        </script>
  </body>
</html>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="#toc">Return to Top</a></p>

</div>
</div>
</div>
</div>
 

