---
keywords: fastai
description: A tutorial of RRAP authentication using Jupyter notebooks.
title: RRAP-IS Provenance Demo Notebook
toc: true 
badges: true
comments: true
categories: [jupyter]
nb_path: _notebooks/2022-07-20-rrap-provenance-demo.ipynb
layout: notebook
---

<!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-07-20-rrap-provenance-demo.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="About">About<a class="anchor-link" href="#About"> </a></h2><p>This notebook is a demonstration of generating a record of a model run and searching the provenance database to identify linkages between data, models, users and organisations with the RRAP-IS system.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Run-all-imports">Run all imports<a class="anchor-link" href="#Run-all-imports"> </a></h3><p>Keep all your imports at the top of a notebook.  It allows for easier management.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">json2html</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">IFrame</span><span class="p">,</span> <span class="n">display</span><span class="p">,</span> <span class="n">HTML</span><span class="p">,</span> <span class="n">JSON</span><span class="p">,</span> <span class="n">Markdown</span><span class="p">,</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">mdsisclienttools.auth.TokenManager</span> <span class="kn">import</span> <span class="n">DeviceFlowManager</span>
<span class="kn">from</span> <span class="nn">urllib.error</span> <span class="kn">import</span> <span class="n">HTTPError</span>
<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">import</span> <span class="nn">nx_altair</span> <span class="k">as</span> <span class="nn">nxa</span>
<span class="kn">from</span> <span class="nn">networkx.readwrite</span> <span class="kn">import</span> <span class="n">json_graph</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">holoviews</span> <span class="k">as</span> <span class="nn">hv</span>
<span class="kn">from</span> <span class="nn">holoviews</span> <span class="kn">import</span> <span class="n">opts</span>
<span class="n">hv</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="s1">&#39;bokeh&#39;</span><span class="p">)</span>
<span class="n">defaults</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
<span class="n">hv</span><span class="o">.</span><span class="n">opts</span><span class="o">.</span><span class="n">defaults</span><span class="p">(</span><span class="n">opts</span><span class="o">.</span><span class="n">EdgePaths</span><span class="p">(</span><span class="o">**</span><span class="n">defaults</span><span class="p">),</span> <span class="n">opts</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="o">**</span><span class="n">defaults</span><span class="p">),</span> <span class="n">opts</span><span class="o">.</span><span class="n">Nodes</span><span class="p">(</span><span class="o">**</span><span class="n">defaults</span><span class="p">))</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">&#39;once&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Define-global-variables">Define global variables<a class="anchor-link" href="#Define-global-variables"> </a></h3><p>Similar to import we like to define notebook variable at the top and reuse them throughout the notebook</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data_api</span> <span class="o">=</span> <span class="s2">&quot;https://data-api.testing.rrap-is.com&quot;</span>
<span class="n">registry_api</span> <span class="o">=</span> <span class="s2">&quot;https://registry-api.testing.rrap-is.com&quot;</span>
<span class="n">prov_api</span> <span class="o">=</span> <span class="s2">&quot;https://prov-api.testing.rrap-is.com&quot;</span>
<span class="n">auth_server</span> <span class="o">=</span> <span class="s2">&quot;https://auth.dev.rrap-is.com/auth/realms/rrap&quot;</span>
<span class="c1"># garbage = &quot;https://frogs.are.green&quot;</span>
<span class="n">base_urls</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;data_api&#39;</span><span class="p">:</span> <span class="n">data_api</span><span class="p">,</span> <span class="s1">&#39;registry_api&#39;</span><span class="p">:</span> <span class="n">registry_api</span><span class="p">,</span> <span class="s1">&#39;prov_api&#39;</span><span class="p">:</span> <span class="n">prov_api</span><span class="p">,</span> <span class="s1">&#39;auth_server&#39;</span><span class="p">:</span> <span class="n">auth_server</span><span class="p">}</span><span class="c1">#, &#39;garbage&#39;: garbage}</span>
<span class="n">display</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Checking base urls&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">base_urls</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Testing - </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="n">r</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; - Passed&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; - Fail&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">SystemExit</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># catastrophic error. bail.</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; - Fail&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">SystemExit</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea ">
<pre>&#39;Checking base urls&#39;</pre>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Testing - https://data-api.testing.rrap-is.com - Passed
Testing - https://registry-api.testing.rrap-is.com - Passed
Testing - https://prov-api.testing.rrap-is.com - Passed
Testing - https://auth.dev.rrap-is.com/auth/realms/rrap - Passed
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Authentication">Authentication<a class="anchor-link" href="#Authentication"> </a></h2><h3 id="Setup-tokens-using-device-authorisation-flow-against-keycloak-server">Setup tokens using device authorisation flow against keycloak server<a class="anchor-link" href="#Setup-tokens-using-device-authorisation-flow-against-keycloak-server"> </a></h3><p>This could result in a browser window being opened if you don't have valid tokens cached in local storage.</p>
<p><a href="#toc">Return to Top</a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">local_token_storage</span> <span class="o">=</span> <span class="s2">&quot;.tokens.json&quot;</span>

<span class="n">token_manager</span> <span class="o">=</span> <span class="n">DeviceFlowManager</span><span class="p">(</span>
    <span class="n">stage</span><span class="o">=</span><span class="s2">&quot;TEST&quot;</span><span class="p">,</span>
    <span class="n">keycloak_endpoint</span><span class="o">=</span><span class="n">auth_server</span><span class="p">,</span>
    <span class="n">local_storage_location</span><span class="o">=</span><span class="n">local_token_storage</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Attempting to generate authorisation tokens.

Looking for existing tokens in local storage.

Validating found tokens

Found tokens valid, using.

</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Helper-functions">Helper functions<a class="anchor-link" href="#Helper-functions"> </a></h2><p><a href="#toc">Return to Top</a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">wrap_html_table</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="n">ul_tag</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;table&quot;</span><span class="p">)</span>
    <span class="n">div_tag</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">new_tag</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">)</span>
    <span class="n">div_tag</span><span class="p">[</span><span class="s1">&#39;style&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;width: auto; height: 400px; overflow-y: auto; &quot;</span>
    <span class="n">ul_tag</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span><span class="n">div_tag</span><span class="p">)</span>
    <span class="n">new_tag</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">new_tag</span><span class="p">(</span><span class="s2">&quot;details&quot;</span><span class="p">)</span>
    <span class="n">div_tag</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span><span class="n">new_tag</span><span class="p">)</span>
    
    <span class="n">tag</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">new_tag</span><span class="p">(</span><span class="s2">&quot;summary&quot;</span><span class="p">)</span>
    <span class="n">tag</span><span class="o">.</span><span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;Results&quot;</span>
    <span class="n">soup</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">insert_after</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">soup</span><span class="o">.</span><span class="n">prettify</span><span class="p">()</span>
    
<span class="k">def</span> <span class="nf">json_to_md</span><span class="p">(</span><span class="n">response_json</span><span class="p">):</span>
        <span class="n">json_obj_in_html</span> <span class="o">=</span> <span class="n">json2html</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span> <span class="n">response_json</span>  <span class="p">)</span>
        <span class="k">return</span> <span class="n">wrap_html_table</span><span class="p">(</span><span class="n">json_obj_in_html</span><span class="p">)</span>
    
<span class="k">def</span> <span class="nf">handle_request</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">params</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="n">auth</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">payload</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="n">auth</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="n">auth</span><span class="p">)</span>
        <span class="c1"># If the response was successful, no Exception will be raised</span>
        <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>

    <span class="k">except</span> <span class="n">HTTPError</span> <span class="k">as</span> <span class="n">http_err</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;HTTP error occurred: </span><span class="si">{</span><span class="n">http_err</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1"># Python 3.6</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="n">http_err</span><span class="p">}</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Other error occurred: </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1"># Python 3.6</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="n">err</span> <span class="p">}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Endpoint-Documentation">Endpoint Documentation<a class="anchor-link" href="#Endpoint-Documentation"> </a></h2><p>Endpoint documentation can be found by appending either <code>/docs</code> or <code>/redoc</code> on the end a base URL.</p>
<p>For example:</p>
<ul>
  <li><a href="https://prov-api.testing.rrap-is.com/redoc" target="_blank">Redoc FastAPI</a></li>
  <li><a href="https://prov-api.testing.rrap-is.com/docs" target="_blank">Docs FastAPI</a> </li>
</ul><p><a href="#toc">Return to Top</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Demonstration">Demonstration<a class="anchor-link" href="#Demonstration"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Register-a-model-run">Register a model run<a class="anchor-link" href="#Register-a-model-run"> </a></h3><p>A model run consists of ten main elements where many have already been registered in the RRAP-IS Registry.</p>
<p>These elements are:</p>
<ul>
<li>Start Time</li>
<li>End Time</li>
<li>Workflow definition*</li>
<li>Input dataset*</li>
<li>Input template*</li>
<li>Output dataset*</li>
<li>Output template*</li>
<li>Modeller* and</li>
<li>Requesting Organisation*</li>
</ul>
<p>*pre-registered elements.</p>
<p>For examples of registering elements please see <a href="/rrap-demo-blog/jupyter/2022/08/18/rrap-registry.html" target="_blank">RRAP-IS Register blog post</a> or <a href="/rrap-demo-blog/jupyter/registry/2022/09/02/registry-query.html" target="_blank">RRAP-IS Register Query blog post</a></p>
<p>see <a href="https://prov-api.testing.rrap-is.com/redoc#tag/Model-Runs/operation/register_model_run_complete_model_run_register_complete_post" target="_blank">Endpoint documentation</a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">auth</span> <span class="o">=</span> <span class="n">token_manager</span><span class="o">.</span><span class="n">get_auth</span>
<span class="n">postfix</span> <span class="o">=</span> <span class="s2">&quot;/model_run/register_complete&quot;</span>
<span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;start_time&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s2">&quot;end_time&quot;</span><span class="p">:</span> <span class="mi">1662467929</span><span class="p">,</span>
  <span class="s2">&quot;workflow_definition&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;10378.1/1691197&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;datasets&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;10378.1/1690478&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;template&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;10378.1/1690478&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;dataset_type&quot;</span><span class="p">:</span> <span class="s2">&quot;DATA_STORE&quot;</span><span class="p">,</span>
        <span class="s2">&quot;dataset&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;10378.1/1688622&quot;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;outputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;datasets&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;10378.1/1690478&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;template&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;10378.1/1690478&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;dataset_type&quot;</span><span class="p">:</span> <span class="s2">&quot;DATA_STORE&quot;</span><span class="p">,</span>
        <span class="s2">&quot;dataset&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;10378.1/1688634&quot;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;associations&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;modeller&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;10378.1/1691160&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;requesting_organisation&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;10378.1/1690557&quot;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="n">endpoint</span> <span class="o">=</span> <span class="n">prov_api</span> <span class="o">+</span> <span class="n">postfix</span> 

<span class="n">response_json</span> <span class="o">=</span> <span class="n">handle_request</span><span class="p">(</span><span class="s1">&#39;POST&#39;</span><span class="p">,</span> <span class="n">endpoint</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">payload</span><span class="p">,</span> <span class="n">auth</span><span class="p">())</span>
<span class="n">HTML</span><span class="p">(</span><span class="n">json_to_md</span><span class="p">(</span><span class="n">response_json</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<html>
 <body>
  <details>
   <div style="width: auto; height: 400px; overflow-y: auto; ">
    <table border="1">
     <tr>
      <th>
       status
      </th>
      <td>
       <table border="1">
        <tr>
         <th>
          success
         </th>
         <td>
          True
         </td>
        </tr>
        <tr>
         <th>
          details
         </th>
         <td>
          All successful.
         </td>
        </tr>
       </table>
      </td>
     </tr>
     <tr>
      <th>
       record_info
      </th>
      <td>
       <table border="1">
        <tr>
         <th>
          id
         </th>
         <td>
          10378.1/1691336
         </td>
        </tr>
        <tr>
         <th>
          prov_json
         </th>
         <td>
          {"prefix": {"default": "http://hdl.handle.net/"}, "activity": {"10378.1/1691336": {"model_run/10378.1/1691336": true, "item_category": "ACTIVITY", "item_subtype": "MODEL_RUN"}}, "entity": {"10378.1/1688622": {"model_run/10378.1/1691336": true, "item_category": "ENTITY", "item_subtype": "DATASET"}, "10378.1/1688634": {"model_run/10378.1/1691336": true, "item_category": "ENTITY", "item_subtype": "DATASET"}, "10378.1/1691197": {"model_run/10378.1/1691336": true, "item_category": "ENTITY", "item_subtype": "MODEL_RUN_WORKFLOW_DEFINITION", "prov:type": {"$": "prov:Collection", "type": "prov:QUALIFIED_NAME"}}, "10378.1/1690478": {"model_run/10378.1/1691336": true, "item_category": "ENTITY", "item_subtype": "DATASET_TEMPLATE"}, "10378.1/1691116": {"model_run/10378.1/1691336": true, "item_category": "ENTITY", "item_subtype": "MODEL"}}, "agent": {"10378.1/1691160": {"model_run/10378.1/1691336": true, "item_category": "AGENT", "item_subtype": "PERSON"}, "10378.1/1690557": {"model_run/10378.1/1691336": true, "item_category": "AGENT", "item_subtype": "ORGANISATION"}}, "used": {"_:id1": {"prov:activity": "10378.1/1691336", "prov:entity": "10378.1/1688622"}, "_:id3": {"prov:activity": "10378.1/1691336", "prov:entity": "10378.1/1691116"}, "_:id4": {"prov:activity": "10378.1/1691336", "prov:entity": "10378.1/1691197"}}, "wasGeneratedBy": {"_:id2": {"prov:entity": "10378.1/1688634", "prov:activity": "10378.1/1691336"}}, "wasAssociatedWith": {"_:id5": {"prov:activity": "10378.1/1691336", "prov:agent": "10378.1/1691160"}, "_:id6": {"prov:activity": "10378.1/1691336", "prov:agent": "10378.1/1690557"}}, "wasAttributedTo": {"_:id7": {"prov:entity": "10378.1/1688634", "prov:agent": "10378.1/1691160"}}, "hadMember": {"_:id8": {"prov:collection": "10378.1/1691197", "prov:entity": "10378.1/1690478"}, "_:id11": {"prov:collection": "10378.1/1691197", "prov:entity": "10378.1/1691116"}}, "wasInfluencedBy": {"_:id9": {"prov:influencee": "10378.1/1688622", "prov:influencer": "10378.1/1690478"}, "_:id10": {"prov:influencee": "10378.1/1688634", "prov:influencer": "10378.1/1690478"}}}
         </td>
        </tr>
        <tr>
         <th>
          record
         </th>
         <td>
          <table border="1">
           <tr>
            <th>
             workflow_definition
            </th>
            <td>
             <table border="1">
              <tr>
               <th>
                id
               </th>
               <td>
                10378.1/1691197
               </td>
              </tr>
             </table>
            </td>
           </tr>
           <tr>
            <th>
             inputs
            </th>
            <td>
             <table border="1">
              <tr>
               <th>
                datasets
               </th>
               <td>
                <table border="1">
                 <tr>
                  <th>
                   10378.1/1690478
                  </th>
                  <td>
                   <table border="1">
                    <tr>
                     <th>
                      template
                     </th>
                     <td>
                      <table border="1">
                       <tr>
                        <th>
                         id
                        </th>
                        <td>
                         10378.1/1690478
                        </td>
                       </tr>
                      </table>
                     </td>
                    </tr>
                    <tr>
                     <th>
                      dataset_type
                     </th>
                     <td>
                      DATA_STORE
                     </td>
                    </tr>
                    <tr>
                     <th>
                      dataset
                     </th>
                     <td>
                      <table border="1">
                       <tr>
                        <th>
                         id
                        </th>
                        <td>
                         10378.1/1688622
                        </td>
                       </tr>
                      </table>
                     </td>
                    </tr>
                   </table>
                  </td>
                 </tr>
                </table>
               </td>
              </tr>
             </table>
            </td>
           </tr>
           <tr>
            <th>
             outputs
            </th>
            <td>
             <table border="1">
              <tr>
               <th>
                datasets
               </th>
               <td>
                <table border="1">
                 <tr>
                  <th>
                   10378.1/1690478
                  </th>
                  <td>
                   <table border="1">
                    <tr>
                     <th>
                      template
                     </th>
                     <td>
                      <table border="1">
                       <tr>
                        <th>
                         id
                        </th>
                        <td>
                         10378.1/1690478
                        </td>
                       </tr>
                      </table>
                     </td>
                    </tr>
                    <tr>
                     <th>
                      dataset_type
                     </th>
                     <td>
                      DATA_STORE
                     </td>
                    </tr>
                    <tr>
                     <th>
                      dataset
                     </th>
                     <td>
                      <table border="1">
                       <tr>
                        <th>
                         id
                        </th>
                        <td>
                         10378.1/1688634
                        </td>
                       </tr>
                      </table>
                     </td>
                    </tr>
                   </table>
                  </td>
                 </tr>
                </table>
               </td>
              </tr>
             </table>
            </td>
           </tr>
           <tr>
            <th>
             associations
            </th>
            <td>
             <table border="1">
              <tr>
               <th>
                modeller
               </th>
               <td>
                <table border="1">
                 <tr>
                  <th>
                   id
                  </th>
                  <td>
                   10378.1/1691160
                  </td>
                 </tr>
                </table>
               </td>
              </tr>
              <tr>
               <th>
                requesting_organisation
               </th>
               <td>
                <table border="1">
                 <tr>
                  <th>
                   id
                  </th>
                  <td>
                   10378.1/1690557
                  </td>
                 </tr>
                </table>
               </td>
              </tr>
             </table>
            </td>
           </tr>
           <tr>
            <th>
             start_time
            </th>
            <td>
             0
            </td>
           </tr>
           <tr>
            <th>
             end_time
            </th>
            <td>
             1662467929
            </td>
           </tr>
          </table>
         </td>
        </tr>
       </table>
      </td>
     </tr>
    </table>
   </div>
   <summary>
    Results
   </summary>
  </details>
 </body>
</html>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Explore-Upstream-Provenance">Explore Upstream Provenance<a class="anchor-link" href="#Explore-Upstream-Provenance"> </a></h3><p><a href="#toc">Return to Top</a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">auth</span> <span class="o">=</span> <span class="n">token_manager</span><span class="o">.</span><span class="n">get_auth</span>
<span class="n">postfix</span> <span class="o">=</span> <span class="s2">&quot;/explore/upstream&quot;</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;starting_id&quot;</span><span class="p">:</span> <span class="s2">&quot;10378.1/1691200&quot;</span><span class="p">,</span>
    <span class="s2">&quot;depth&quot;</span><span class="p">:</span> <span class="mi">10</span>
<span class="p">}</span>
<span class="n">endpoint</span> <span class="o">=</span> <span class="n">prov_api</span> <span class="o">+</span> <span class="n">postfix</span>

<span class="n">response_json</span> <span class="o">=</span> <span class="n">handle_request</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="n">endpoint</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">auth</span><span class="p">())</span>
<span class="n">result_graph</span> <span class="o">=</span> <span class="n">response_json</span><span class="p">[</span><span class="s2">&quot;graph&quot;</span><span class="p">]</span>

<span class="n">networkx_graph</span> <span class="o">=</span> <span class="n">json_graph</span><span class="o">.</span><span class="n">node_link_graph</span><span class="p">(</span><span class="n">result_graph</span><span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">hv</span><span class="o">.</span><span class="n">Graph</span><span class="o">.</span><span class="n">from_networkx</span><span class="p">(</span><span class="n">networkx_graph</span><span class="p">,</span> <span class="n">nx</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">circular_layout</span><span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span><span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;hover&#39;</span><span class="p">,</span><span class="s1">&#39;tap&#39;</span><span class="p">],</span>
                                                                          <span class="n">node_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                                                          <span class="n">node_color</span><span class="o">=</span><span class="s1">&#39;item_category&#39;</span><span class="p">,</span>
                                                                          <span class="n">cmap</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">],</span>
                                                                          <span class="n">directed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                                                          <span class="n">arrowhead_length</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span>
                                                                          <span class="n">bgcolor</span><span class="o">=</span><span class="s1">&#39;pink&#39;</span><span class="p">)</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">hv</span><span class="o">.</span><span class="n">Labels</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">nodes</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="s1">&#39;item_category&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span><span class="n">opts</span><span class="o">.</span><span class="n">Labels</span><span class="p">(</span><span class="n">text_font_size</span><span class="o">=</span><span class="s1">&#39;12pt&#39;</span><span class="p">,</span> <span class="n">text_color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">xoffset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">yoffset</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">bgcolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">))</span>
<span class="n">labels_2</span> <span class="o">=</span> <span class="n">hv</span><span class="o">.</span><span class="n">Labels</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">nodes</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="s1">&#39;item_subtype&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span><span class="n">opts</span><span class="o">.</span><span class="n">Labels</span><span class="p">(</span><span class="n">text_font_size</span><span class="o">=</span><span class="s1">&#39;8pt&#39;</span><span class="p">,</span> <span class="n">xoffset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">yoffset</span><span class="o">=-</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">bgcolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">))</span>
<span class="n">hv_graph</span> <span class="o">=</span> <span class="p">(</span><span class="n">im</span> <span class="o">*</span> <span class="n">labels</span> <span class="o">*</span> <span class="n">labels_2</span><span class="p">)</span>

<span class="n">hv</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">hv_graph</span><span class="p">,</span> <span class="s1">&#39;lineage_network.html&#39;</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">&#39;bokeh&#39;</span><span class="p">)</span>

<span class="n">HTML</span><span class="p">(</span><span class="s1">&#39;lineage_network.html&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">


<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="utf-8">
      <title>lineage_network</title>
              <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.css" type="text/css" />
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" type="text/css" />
            <link rel="stylesheet" href="https://unpkg.com/@holoviz/panel@0.13.1/dist/css/loading.css" type="text/css" />
            <link rel="stylesheet" href="https://unpkg.com/@holoviz/panel@0.13.1/dist/css/debugger.css" type="text/css" />
            <link rel="stylesheet" href="https://unpkg.com/@holoviz/panel@0.13.1/dist/css/json.css" type="text/css" />
            <link rel="stylesheet" href="https://unpkg.com/@holoviz/panel@0.13.1/dist/css/alerts.css" type="text/css" />
            <link rel="stylesheet" href="https://unpkg.com/@holoviz/panel@0.13.1/dist/css/dataframe.css" type="text/css" />
            <link rel="stylesheet" href="https://unpkg.com/@holoviz/panel@0.13.1/dist/css/card.css" type="text/css" />
            <link rel="stylesheet" href="https://unpkg.com/@holoviz/panel@0.13.1/dist/css/widgets.css" type="text/css" />
            <link rel="stylesheet" href="https://unpkg.com/@holoviz/panel@0.13.1/dist/css/markdown.css" type="text/css" />
            <style>
                
            .bk.pn-loading.arcs:before {
              background-image: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBzdHlsZT0ibWFyZ2luOiBhdXRvOyBiYWNrZ3JvdW5kOiBub25lOyBkaXNwbGF5OiBibG9jazsgc2hhcGUtcmVuZGVyaW5nOiBhdXRvOyIgdmlld0JveD0iMCAwIDEwMCAxMDAiIHByZXNlcnZlQXNwZWN0UmF0aW89InhNaWRZTWlkIj4gIDxjaXJjbGUgY3g9IjUwIiBjeT0iNTAiIHI9IjMyIiBzdHJva2Utd2lkdGg9IjgiIHN0cm9rZT0iI2MzYzNjMyIgc3Ryb2tlLWRhc2hhcnJheT0iNTAuMjY1NDgyNDU3NDM2NjkgNTAuMjY1NDgyNDU3NDM2NjkiIGZpbGw9Im5vbmUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCI+ICAgIDxhbmltYXRlVHJhbnNmb3JtIGF0dHJpYnV0ZU5hbWU9InRyYW5zZm9ybSIgdHlwZT0icm90YXRlIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIgZHVyPSIxcyIga2V5VGltZXM9IjA7MSIgdmFsdWVzPSIwIDUwIDUwOzM2MCA1MCA1MCI+PC9hbmltYXRlVHJhbnNmb3JtPiAgPC9jaXJjbGU+PC9zdmc+");
              background-size: auto calc(min(50%, 400px));
            }
            
            </style>

          <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-2.4.3.min.js"></script><script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-gl-2.4.3.min.js"></script><script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-widgets-2.4.3.min.js"></script><script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-tables-2.4.3.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.js"></script><script type="text/javascript" src="https://unpkg.com/@holoviz/panel@0.13.1/dist/panel.min.js"></script><script type="text/javascript">
            Bokeh.set_log_level("info");
        </script>
  </head>
  <body>
          
              <div class="bk-root" id="2c886668-4d5f-4c3a-ae10-b1d6ee642493" data-root-id="7060"></div>
      
        <script type="application/json" id="7301">
          {"ad02f0ae-62b4-44eb-84e7-442a29909cf8":{"defs":[{"extends":null,"module":null,"name":"ReactiveHTML1","overrides":[],"properties":[]},{"extends":null,"module":null,"name":"FlexBox1","overrides":[],"properties":[{"default":"flex-start","kind":null,"name":"align_content"},{"default":"flex-start","kind":null,"name":"align_items"},{"default":"row","kind":null,"name":"flex_direction"},{"default":"wrap","kind":null,"name":"flex_wrap"},{"default":"flex-start","kind":null,"name":"justify_content"}]},{"extends":null,"module":null,"name":"GridStack1","overrides":[],"properties":[{"default":"warn","kind":null,"name":"mode"},{"default":null,"kind":null,"name":"ncols"},{"default":null,"kind":null,"name":"nrows"},{"default":true,"kind":null,"name":"allow_resize"},{"default":true,"kind":null,"name":"allow_drag"},{"default":[],"kind":null,"name":"state"}]},{"extends":null,"module":null,"name":"click1","overrides":[],"properties":[{"default":"","kind":null,"name":"terminal_output"},{"default":"","kind":null,"name":"debug_name"},{"default":0,"kind":null,"name":"clears"}]},{"extends":null,"module":null,"name":"NotificationAreaBase1","overrides":[],"properties":[{"default":"bottom-right","kind":null,"name":"position"},{"default":0,"kind":null,"name":"_clear"}]},{"extends":null,"module":null,"name":"NotificationArea1","overrides":[],"properties":[{"default":[],"kind":null,"name":"notifications"},{"default":"bottom-right","kind":null,"name":"position"},{"default":0,"kind":null,"name":"_clear"},{"default":[{"background":"#ffc107","icon":{"className":"fas fa-exclamation-triangle","color":"white","tagName":"i"},"type":"warning"},{"background":"#007bff","icon":{"className":"fas fa-info-circle","color":"white","tagName":"i"},"type":"info"}],"kind":null,"name":"types"}]},{"extends":null,"module":null,"name":"Notification","overrides":[],"properties":[{"default":null,"kind":null,"name":"background"},{"default":3000,"kind":null,"name":"duration"},{"default":null,"kind":null,"name":"icon"},{"default":"","kind":null,"name":"message"},{"default":null,"kind":null,"name":"notification_type"},{"default":false,"kind":null,"name":"_destroyed"}]},{"extends":null,"module":null,"name":"TemplateActions1","overrides":[],"properties":[{"default":0,"kind":null,"name":"open_modal"},{"default":0,"kind":null,"name":"close_modal"}]},{"extends":null,"module":null,"name":"MaterialTemplateActions1","overrides":[],"properties":[{"default":0,"kind":null,"name":"open_modal"},{"default":0,"kind":null,"name":"close_modal"}]}],"roots":{"references":[{"attributes":{"text":{"field":"item_category"},"text_align":{"value":"center"},"text_alpha":{"value":0.2},"text_baseline":{"value":"middle"},"text_color":{"value":"blue"},"text_font_size":{"value":"12pt"},"x":{"field":"x","transform":{"id":"7133"}},"y":{"field":"y","transform":{"id":"7134"}}},"id":"7140","type":"Text"},{"attributes":{"callback":null,"renderers":[{"id":"7120"}],"tags":["hv_created"],"tooltips":[["index","@{index_hover}"],["item_category","@{item_category}"],["item_subtype","@{item_subtype}"]]},"id":"7064","type":"HoverTool"},{"attributes":{"fill_color":{"field":"node_color","transform":{"id":"7103"}},"hatch_color":{"field":"node_color","transform":{"id":"7103"}},"size":{"value":10}},"id":"7107","type":"Circle"},{"attributes":{"range":null,"value":-0.05},"id":"7145","type":"Dodge"},{"attributes":{"source":{"id":"7135"}},"id":"7142","type":"CDSView"},{"attributes":{"coordinates":null,"data_source":{"id":"7135"},"glyph":{"id":"7138"},"group":null,"hover_glyph":null,"muted_glyph":{"id":"7140"},"nonselection_glyph":{"id":"7139"},"selection_glyph":{"id":"7143"},"view":{"id":"7142"}},"id":"7141","type":"GlyphRenderer"},{"attributes":{},"id":"7099","type":"AllLabels"},{"attributes":{},"id":"7098","type":"BasicTickFormatter"},{"attributes":{"text":{"field":"item_category"},"text_align":{"value":"center"},"text_alpha":{"value":0.1},"text_baseline":{"value":"middle"},"text_color":{"value":"blue"},"text_font_size":{"value":"12pt"},"x":{"field":"x","transform":{"id":"7133"}},"y":{"field":"y","transform":{"id":"7134"}}},"id":"7139","type":"Text"},{"attributes":{"margin":[5,5,5,5],"name":"HSpacer09656","sizing_mode":"stretch_width"},"id":"7061","type":"Spacer"},{"attributes":{"text":{"field":"item_category"},"text_align":{"value":"center"},"text_baseline":{"value":"middle"},"text_color":{"value":"blue"},"text_font_size":{"value":"12pt"},"x":{"field":"x","transform":{"id":"7133"}},"y":{"field":"y","transform":{"id":"7134"}}},"id":"7138","type":"Text"},{"attributes":{"angle":{"value":0},"text":{"field":"item_category"},"text_align":{"value":"center"},"text_alpha":{"value":1.0},"text_baseline":{"value":"middle"},"text_color":{"value":"blue"},"text_font_size":{"value":"12pt"},"text_font_style":{"value":"normal"},"text_line_height":{"value":1.2},"x":{"field":"x","transform":{"id":"7133"}},"x_offset":{"value":0},"y":{"field":"y","transform":{"id":"7134"}},"y_offset":{"value":0}},"id":"7143","type":"Text"},{"attributes":{},"id":"7101","type":"BasicTickFormatter"},{"attributes":{"text":{"field":"item_subtype"},"text_align":{"value":"center"},"text_alpha":{"value":0.2},"text_baseline":{"value":"middle"},"text_color":{"value":"black"},"text_font_size":{"value":"8pt"},"x":{"field":"x","transform":{"id":"7144"}},"y":{"field":"y","transform":{"id":"7145"}}},"id":"7151","type":"Text"},{"attributes":{},"id":"7102","type":"AllLabels"},{"attributes":{},"id":"7169","type":"UnionRenderers"},{"attributes":{},"id":"7070","type":"LinearScale"},{"attributes":{},"id":"7170","type":"Selection"},{"attributes":{"line_width":{"value":2}},"id":"7114","type":"MultiLine"},{"attributes":{"fill_color":{"value":"limegreen"},"hatch_color":{"field":"node_color","transform":{"id":"7103"}},"size":{"value":10}},"id":"7110","type":"Circle"},{"attributes":{},"id":"7162","type":"UnionRenderers"},{"attributes":{"range":null},"id":"7144","type":"Dodge"},{"attributes":{},"id":"7075","type":"BasicTicker"},{"attributes":{"factors":["ENTITY","AGENT","ACTIVITY"],"palette":["blue","orange","green"]},"id":"7103","type":"CategoricalColorMapper"},{"attributes":{"source":{"id":"7105"}},"id":"7119","type":"CDSView"},{"attributes":{},"id":"7083","type":"PanTool"},{"attributes":{"axis_label":"x","coordinates":null,"formatter":{"id":"7098"},"group":null,"major_label_policy":{"id":"7099"},"ticker":{"id":"7075"}},"id":"7074","type":"LinearAxis"},{"attributes":{"text":{"field":"item_subtype"},"text_align":{"value":"center"},"text_alpha":{"value":0.1},"text_baseline":{"value":"middle"},"text_color":{"value":"black"},"text_font_size":{"value":"8pt"},"x":{"field":"x","transform":{"id":"7144"}},"y":{"field":"y","transform":{"id":"7145"}}},"id":"7150","type":"Text"},{"attributes":{},"id":"7129","type":"NodesAndLinkedEdges"},{"attributes":{},"id":"7164","type":"UnionRenderers"},{"attributes":{"coordinates":null,"edge_renderer":{"id":"7118"},"group":null,"inspection_policy":{"id":"7131"},"layout_provider":{"id":"7106"},"node_renderer":{"id":"7112"},"selection_policy":{"id":"7129"}},"id":"7120","type":"GraphRenderer"},{"attributes":{"children":[{"id":"7061"},{"id":"7065"},{"id":"7171"}],"margin":[0,0,0,0],"name":"Row09652","tags":["embedded"]},"id":"7060","type":"Row"},{"attributes":{"coordinates":null,"group":null,"text_color":"black","text_font_size":"12pt"},"id":"7066","type":"Title"},{"attributes":{},"id":"7072","type":"LinearScale"},{"attributes":{"text":{"field":"item_subtype"},"text_align":{"value":"center"},"text_baseline":{"value":"middle"},"text_color":{"value":"black"},"text_font_size":{"value":"8pt"},"x":{"field":"x","transform":{"id":"7144"}},"y":{"field":"y","transform":{"id":"7145"}}},"id":"7149","type":"Text"},{"attributes":{"fill_alpha":{"value":0.2},"fill_color":{"field":"node_color","transform":{"id":"7103"}},"hatch_alpha":{"value":0.2},"hatch_color":{"field":"node_color","transform":{"id":"7103"}},"line_alpha":{"value":0.2},"size":{"value":10}},"id":"7108","type":"Circle"},{"attributes":{"fill_alpha":{"value":0.2},"fill_color":{"field":"node_color","transform":{"id":"7103"}},"hatch_alpha":{"value":0.2},"hatch_color":{"field":"node_color","transform":{"id":"7103"}},"line_alpha":{"value":0.2},"size":{"value":10}},"id":"7111","type":"Circle"},{"attributes":{},"id":"7147","type":"Selection"},{"attributes":{"axis":{"id":"7074"},"coordinates":null,"grid_line_color":null,"group":null,"ticker":null},"id":"7077","type":"Grid"},{"attributes":{"data":{"item_category":["ENTITY","ENTITY","AGENT","ENTITY","AGENT","ENTITY","ACTIVITY"],"x":{"__ndarray__":"fH/i5qDz4z/q0ZSmkHvMv7N/4oag8+M/Jks9fbzU7L+h0ZQmkXvMvyZLPX281Oy/AAAAAAAA8D8=","dtype":"float64","order":"little","shape":[7]},"y":{"__ndarray__":"vWtGdsME6T9Rgr7ymzLvP1PZIa3DBOm/X21GmcDE2z8M8JnpmzLvv/xI/UbAxNu/RDTWhyRJQj4=","dtype":"float64","order":"little","shape":[7]}},"selected":{"id":"7136"},"selection_policy":{"id":"7162"}},"id":"7135","type":"ColumnDataSource"},{"attributes":{"axis_label":"y","coordinates":null,"formatter":{"id":"7101"},"group":null,"major_label_policy":{"id":"7102"},"ticker":{"id":"7079"}},"id":"7078","type":"LinearAxis"},{"attributes":{"coordinates":null,"data_source":{"id":"7104"},"glyph":{"id":"7107"},"group":null,"hover_glyph":{"id":"7110"},"muted_glyph":{"id":"7111"},"nonselection_glyph":{"id":"7108"},"selection_glyph":{"id":"7109"},"view":{"id":"7113"}},"id":"7112","type":"GlyphRenderer"},{"attributes":{"source":{"id":"7146"}},"id":"7153","type":"CDSView"},{"attributes":{"axis":{"id":"7078"},"coordinates":null,"dimension":1,"grid_line_color":null,"group":null,"ticker":null},"id":"7081","type":"Grid"},{"attributes":{"coordinates":null,"data_source":{"id":"7146"},"glyph":{"id":"7149"},"group":null,"hover_glyph":null,"muted_glyph":{"id":"7151"},"nonselection_glyph":{"id":"7150"},"selection_glyph":{"id":"7154"},"view":{"id":"7153"}},"id":"7152","type":"GlyphRenderer"},{"attributes":{},"id":"7079","type":"BasicTicker"},{"attributes":{"data":{"item_subtype":["DATASET","DATASET_TEMPLATE","ORGANISATION","MODEL","PERSON","MODEL_RUN_WORKFLOW_DEFINITION","MODEL_RUN"],"x":{"__ndarray__":"fH/i5qDz4z/q0ZSmkHvMv7N/4oag8+M/Jks9fbzU7L+h0ZQmkXvMvyZLPX281Oy/AAAAAAAA8D8=","dtype":"float64","order":"little","shape":[7]},"y":{"__ndarray__":"vWtGdsME6T9Rgr7ymzLvP1PZIa3DBOm/X21GmcDE2z8M8JnpmzLvv/xI/UbAxNu/RDTWhyRJQj4=","dtype":"float64","order":"little","shape":[7]}},"selected":{"id":"7147"},"selection_policy":{"id":"7164"}},"id":"7146","type":"ColumnDataSource"},{"attributes":{},"id":"7084","type":"WheelZoomTool"},{"attributes":{"end":1.1425726588684266,"reset_end":1.1425726588684266,"reset_start":-1.0435414437807817,"start":-1.0435414437807817,"tags":[[["x","x",null]]]},"id":"7062","type":"Range1d"},{"attributes":{"line_alpha":{"value":0.2},"line_width":{"value":2}},"id":"7117","type":"MultiLine"},{"attributes":{"angle":{"value":0},"text":{"field":"item_subtype"},"text_align":{"value":"center"},"text_alpha":{"value":1.0},"text_baseline":{"value":"middle"},"text_color":{"value":"black"},"text_font_size":{"value":"8pt"},"text_font_style":{"value":"normal"},"text_line_height":{"value":1.2},"x":{"field":"x","transform":{"id":"7144"}},"x_offset":{"value":0},"y":{"field":"y","transform":{"id":"7145"}},"y_offset":{"value":0}},"id":"7154","type":"Text"},{"attributes":{},"id":"7082","type":"SaveTool"},{"attributes":{"margin":[5,5,5,5],"name":"HSpacer09657","sizing_mode":"stretch_width"},"id":"7171","type":"Spacer"},{"attributes":{"overlay":{"id":"7088"}},"id":"7085","type":"BoxZoomTool"},{"attributes":{},"id":"7086","type":"ResetTool"},{"attributes":{"line_alpha":{"value":0.2},"line_width":{"value":2}},"id":"7115","type":"MultiLine"},{"attributes":{},"id":"7131","type":"NodesAndLinkedEdges"},{"attributes":{"callback":null},"id":"7087","type":"TapTool"},{"attributes":{"bottom_units":"screen","coordinates":null,"fill_alpha":0.5,"fill_color":"lightgrey","group":null,"left_units":"screen","level":"overlay","line_alpha":1.0,"line_color":"black","line_dash":[4,4],"line_width":2,"right_units":"screen","syncable":false,"top_units":"screen"},"id":"7088","type":"BoxAnnotation"},{"attributes":{},"id":"7136","type":"Selection"},{"attributes":{"tools":[{"id":"7064"},{"id":"7082"},{"id":"7083"},{"id":"7084"},{"id":"7085"},{"id":"7086"},{"id":"7087"}]},"id":"7089","type":"Toolbar"},{"attributes":{"line_color":{"value":"limegreen"},"line_width":{"value":2}},"id":"7116","type":"MultiLine"},{"attributes":{"data":{"index":{"__ndarray__":"AAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAA==","dtype":"int32","order":"little","shape":[7]},"index_hover":["10378.1/1688622","10378.1/1690478","10378.1/1690557","10378.1/1691116","10378.1/1691160","10378.1/1691197","10378.1/1691200"],"item_category":["ENTITY","ENTITY","AGENT","ENTITY","AGENT","ENTITY","ACTIVITY"],"item_subtype":["DATASET","DATASET_TEMPLATE","ORGANISATION","MODEL","PERSON","MODEL_RUN_WORKFLOW_DEFINITION","MODEL_RUN"],"node_color":["ENTITY","ENTITY","AGENT","ENTITY","AGENT","ENTITY","ACTIVITY"]},"selected":{"id":"7168"},"selection_policy":{"id":"7167"}},"id":"7104","type":"ColumnDataSource"},{"attributes":{"source":{"id":"7104"}},"id":"7113","type":"CDSView"},{"attributes":{"graph_layout":{"0":[0.6234898099391866,0.7818314848003564],"1":[-0.22252090581754597,0.9749278775307834],"2":[0.6234896311252583,-0.7818315869797438],"3":[-0.9009687849123551,0.4338838097407542],"4":[-0.22252096542218872,-0.9749278605008853],"5":[-0.9009687849123551,-0.43388373310621353],"6":[1.0,8.514948963609798e-09]}},"id":"7106","type":"StaticLayoutProvider"},{"attributes":{"range":null},"id":"7133","type":"Dodge"},{"attributes":{"coordinates":null,"data_source":{"id":"7105"},"glyph":{"id":"7114"},"group":null,"hover_glyph":{"id":"7116"},"muted_glyph":{"id":"7117"},"nonselection_glyph":{"id":"7115"},"view":{"id":"7119"}},"id":"7118","type":"GlyphRenderer"},{"attributes":{"data":{"end":{"__ndarray__":"AAAAAAMAAAAFAAAABAAAAAIAAAABAAAAAQAAAAMAAAA=","dtype":"int32","order":"little","shape":[8]},"start":{"__ndarray__":"BgAAAAYAAAAGAAAABgAAAAYAAAAAAAAABQAAAAUAAAA=","dtype":"int32","order":"little","shape":[8]},"xs":[{"__ndarray__":"AAAAAAAA8D98f+LmoPPjPwAAAAAAAPh/BPVEek5A5T98f+LmoPPjP0YnXSSlDOQ/","dtype":"float64","order":"little","shape":[6]},{"__ndarray__":"AAAAAAAA8D8mSz19vNTsvwAAAAAAAPh/QMDlguAc678mSz19vNTsv7qVSvXcaOu/","dtype":"float64","order":"little","shape":[6]},{"__ndarray__":"AAAAAAAA8D8mSz19vNTsvwAAAAAAAPh/dX7J9Nxo678mSz19vNTsv1ceC4PgHOu/","dtype":"float64","order":"little","shape":[6]},{"__ndarray__":"AAAAAAAA8D+h0ZQmkXvMvwAAAAAAAPh/9Q2Q/Uscyb+h0ZQmkXvMv3rb5dupyMW/","dtype":"float64","order":"little","shape":[6]},{"__ndarray__":"AAAAAAAA8D+zf+KGoPPjPwAAAAAAAPh/GzULyKQM5D+zf+KGoPPjP1CuuRxOQOU/","dtype":"float64","order":"little","shape":[6]},{"__ndarray__":"fH/i5qDz4z/q0ZSmkHvMvwAAAAAAAPh/Un64viCcxb/q0ZSmkHvMvxwKlYESzMa/","dtype":"float64","order":"little","shape":[6]},{"__ndarray__":"Jks9fbzU7L/q0ZSmkHvMvwAAAAAAAPh/NVK+mqHfzL/q0ZSmkHvMvxx1eXkj19C/","dtype":"float64","order":"little","shape":[6]},{"__ndarray__":"Jks9fbzU7L8mSz19vNTsvwAAAAAAAPh/0pjjPv8p7L8mSz19vNTsv3r9lrt5f+2/","dtype":"float64","order":"little","shape":[6]}],"ys":[{"__ndarray__":"RDTWhyRJQj69a0Z2wwTpPwAAAAAAAPh/i4h92Xbb5z+9a0Z2wwTpP+Ch0mNNR+c/","dtype":"float64","order":"little","shape":[6]},{"__ndarray__":"RDTWhyRJQj5fbUaZwMTbPwAAAAAAAPh/w3rG9Tha3D9fbUaZwMTbP88q8INjwNk/","dtype":"float64","order":"little","shape":[6]},{"__ndarray__":"RDTWhyRJQj78SP1GwMTbvwAAAAAAAPh/9OUSM2PA2b/8SP1GwMTbv1syNaU4Wty/","dtype":"float64","order":"little","shape":[6]},{"__ndarray__":"RDTWhyRJQj4M8JnpmzLvvwAAAAAAAPh/rtSO2x2s7b8M8JnpmzLvv2Cph2IYt+6/","dtype":"float64","order":"little","shape":[6]},{"__ndarray__":"RDTWhyRJQj5T2SGtwwTpvwAAAAAAAPh/C/fimk1H579T2SGtwwTpv7uAGBN32+e/","dtype":"float64","order":"little","shape":[6]},{"__ndarray__":"vWtGdsME6T9Rgr7ymzLvPwAAAAAAAPh/fkM2I1h97z9Rgr7ymzLvPygI6WltMO4/","dtype":"float64","order":"little","shape":[6]},{"__ndarray__":"/Ej9RsDE279Rgr7ymzLvPwAAAAAAAPh/PWpE4CV17T9Rgr7ymzLvP9PEoVVPCe4/","dtype":"float64","order":"little","shape":[6]},{"__ndarray__":"/Ej9RsDE279fbUaZwMTbPwAAAAAAAPh/pESYs1mM2D9fbUaZwMTbP6REmLNZjNg/","dtype":"float64","order":"little","shape":[6]}]},"selected":{"id":"7170"},"selection_policy":{"id":"7169"}},"id":"7105","type":"ColumnDataSource"},{"attributes":{"range":null,"value":0.05},"id":"7134","type":"Dodge"},{"attributes":{"end":1.1699134513339502,"reset_end":1.1699134513339502,"reset_start":-1.1699134343040523,"start":-1.1699134343040523,"tags":[[["y","y",null]]]},"id":"7063","type":"Range1d"},{"attributes":{"background_fill_color":"pink","below":[{"id":"7074"}],"center":[{"id":"7077"},{"id":"7081"}],"left":[{"id":"7078"}],"margin":[5,5,5,5],"min_border_bottom":10,"min_border_left":10,"min_border_right":10,"min_border_top":10,"renderers":[{"id":"7120"},{"id":"7141"},{"id":"7152"}],"sizing_mode":"fixed","title":{"id":"7066"},"toolbar":{"id":"7089"},"width":800,"x_range":{"id":"7062"},"x_scale":{"id":"7070"},"y_range":{"id":"7063"},"y_scale":{"id":"7072"}},"id":"7065","subtype":"Figure","type":"Plot"},{"attributes":{},"id":"7167","type":"UnionRenderers"},{"attributes":{"fill_color":{"field":"node_color","transform":{"id":"7103"}},"hatch_color":{"field":"node_color","transform":{"id":"7103"}},"size":{"value":10}},"id":"7109","type":"Circle"},{"attributes":{},"id":"7168","type":"Selection"}],"root_ids":["7060"]},"title":"Bokeh Application","version":"2.4.3"}}
        </script>
        <script type="text/javascript">
          (function() {
            const fn = function() {
              Bokeh.safely(function() {
                (function(root) {
                  function embed_document(root) {
                  const docs_json = document.getElementById('7301').textContent;
                  const render_items = [{"docid":"ad02f0ae-62b4-44eb-84e7-442a29909cf8","root_ids":["7060"],"roots":{"7060":"2c886668-4d5f-4c3a-ae10-b1d6ee642493"}}];
                  root.Bokeh.embed.embed_items(docs_json, render_items);
                  }
                  if (root.Bokeh !== undefined) {
                    embed_document(root);
                  } else {
                    let attempts = 0;
                    const timer = setInterval(function(root) {
                      if (root.Bokeh !== undefined) {
                        clearInterval(timer);
                        embed_document(root);
                      } else {
                        attempts++;
                        if (attempts > 100) {
                          clearInterval(timer);
                          console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
                        }
                      }
                    }, 10, root)
                  }
                })(window);
              });
            };
            if (document.readyState != "loading") fn();
            else document.addEventListener("DOMContentLoaded", fn);
          })();
        </script>
  </body>
</html>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Explore-Downstream-Provence">Explore Downstream Provence<a class="anchor-link" href="#Explore-Downstream-Provence"> </a></h3><p><a href="#toc">Return to Top</a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">auth</span> <span class="o">=</span> <span class="n">token_manager</span><span class="o">.</span><span class="n">get_auth</span>
<span class="n">postfix</span> <span class="o">=</span> <span class="s2">&quot;/explore/downstream&quot;</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;starting_id&quot;</span><span class="p">:</span> <span class="s2">&quot;10378.1/1691200&quot;</span>
<span class="p">}</span>
<span class="n">endpoint</span> <span class="o">=</span> <span class="n">prov_api</span> <span class="o">+</span> <span class="n">postfix</span> 

<span class="n">response_json</span> <span class="o">=</span> <span class="n">handle_request</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="n">endpoint</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">auth</span><span class="p">())</span>
<span class="n">result_graph</span> <span class="o">=</span> <span class="n">response_json</span><span class="p">[</span><span class="s2">&quot;graph&quot;</span><span class="p">]</span>

<span class="n">networkx_graph</span> <span class="o">=</span> <span class="n">json_graph</span><span class="o">.</span><span class="n">node_link_graph</span><span class="p">(</span><span class="n">result_graph</span><span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">hv</span><span class="o">.</span><span class="n">Graph</span><span class="o">.</span><span class="n">from_networkx</span><span class="p">(</span><span class="n">networkx_graph</span><span class="p">,</span> <span class="n">nx</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">fruchterman_reingold_layout</span><span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span><span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;hover&#39;</span><span class="p">,</span><span class="s1">&#39;tap&#39;</span><span class="p">],</span>
                                                                          <span class="n">node_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                                                          <span class="n">node_color</span><span class="o">=</span><span class="s1">&#39;item_category&#39;</span><span class="p">,</span>
                                                                          <span class="n">cmap</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">],</span>
                                                                          <span class="n">directed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                                                          <span class="n">arrowhead_length</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span>
                                                                          <span class="n">bgcolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">hv</span><span class="o">.</span><span class="n">Labels</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">nodes</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="s1">&#39;item_category&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span><span class="n">opts</span><span class="o">.</span><span class="n">Labels</span><span class="p">(</span><span class="n">text_font_size</span><span class="o">=</span><span class="s1">&#39;12pt&#39;</span><span class="p">,</span> <span class="n">text_color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">xoffset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">yoffset</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">bgcolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">))</span>
<span class="n">labels_2</span> <span class="o">=</span> <span class="n">hv</span><span class="o">.</span><span class="n">Labels</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">nodes</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="s1">&#39;item_subtype&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span><span class="n">opts</span><span class="o">.</span><span class="n">Labels</span><span class="p">(</span><span class="n">text_font_size</span><span class="o">=</span><span class="s1">&#39;8pt&#39;</span><span class="p">,</span> <span class="n">xoffset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">yoffset</span><span class="o">=-</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">bgcolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">))</span>
<span class="n">hv_graph</span> <span class="o">=</span> <span class="p">(</span><span class="n">im</span> <span class="o">*</span> <span class="n">labels</span> <span class="o">*</span> <span class="n">labels_2</span><span class="p">)</span>

<span class="n">hv</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">hv_graph</span><span class="p">,</span> <span class="s1">&#39;network.html&#39;</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">&#39;bokeh&#39;</span><span class="p">)</span>

<span class="n">HTML</span><span class="p">(</span><span class="s2">&quot;network.html&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">


<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="utf-8">
      <title>network</title>
              <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.css" type="text/css" />
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" type="text/css" />
            <link rel="stylesheet" href="https://unpkg.com/@holoviz/panel@0.13.1/dist/css/loading.css" type="text/css" />
            <link rel="stylesheet" href="https://unpkg.com/@holoviz/panel@0.13.1/dist/css/debugger.css" type="text/css" />
            <link rel="stylesheet" href="https://unpkg.com/@holoviz/panel@0.13.1/dist/css/json.css" type="text/css" />
            <link rel="stylesheet" href="https://unpkg.com/@holoviz/panel@0.13.1/dist/css/alerts.css" type="text/css" />
            <link rel="stylesheet" href="https://unpkg.com/@holoviz/panel@0.13.1/dist/css/dataframe.css" type="text/css" />
            <link rel="stylesheet" href="https://unpkg.com/@holoviz/panel@0.13.1/dist/css/card.css" type="text/css" />
            <link rel="stylesheet" href="https://unpkg.com/@holoviz/panel@0.13.1/dist/css/widgets.css" type="text/css" />
            <link rel="stylesheet" href="https://unpkg.com/@holoviz/panel@0.13.1/dist/css/markdown.css" type="text/css" />
            <style>
                
            .bk.pn-loading.arcs:before {
              background-image: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBzdHlsZT0ibWFyZ2luOiBhdXRvOyBiYWNrZ3JvdW5kOiBub25lOyBkaXNwbGF5OiBibG9jazsgc2hhcGUtcmVuZGVyaW5nOiBhdXRvOyIgdmlld0JveD0iMCAwIDEwMCAxMDAiIHByZXNlcnZlQXNwZWN0UmF0aW89InhNaWRZTWlkIj4gIDxjaXJjbGUgY3g9IjUwIiBjeT0iNTAiIHI9IjMyIiBzdHJva2Utd2lkdGg9IjgiIHN0cm9rZT0iI2MzYzNjMyIgc3Ryb2tlLWRhc2hhcnJheT0iNTAuMjY1NDgyNDU3NDM2NjkgNTAuMjY1NDgyNDU3NDM2NjkiIGZpbGw9Im5vbmUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCI+ICAgIDxhbmltYXRlVHJhbnNmb3JtIGF0dHJpYnV0ZU5hbWU9InRyYW5zZm9ybSIgdHlwZT0icm90YXRlIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIgZHVyPSIxcyIga2V5VGltZXM9IjA7MSIgdmFsdWVzPSIwIDUwIDUwOzM2MCA1MCA1MCI+PC9hbmltYXRlVHJhbnNmb3JtPiAgPC9jaXJjbGU+PC9zdmc+");
              background-size: auto calc(min(50%, 400px));
            }
            
            </style>

          <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-2.4.3.min.js"></script><script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-gl-2.4.3.min.js"></script><script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-widgets-2.4.3.min.js"></script><script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-tables-2.4.3.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.js"></script><script type="text/javascript" src="https://unpkg.com/@holoviz/panel@0.13.1/dist/panel.min.js"></script><script type="text/javascript">
            Bokeh.set_log_level("info");
        </script>
  </head>
  <body>
          
              <div class="bk-root" id="339bf584-8b4f-4908-8aa7-4f87d6590f3c" data-root-id="6818"></div>
      
        <script type="application/json" id="7059">
          {"2a1aad01-9541-4f2c-887e-3d35bbd6ecc3":{"defs":[{"extends":null,"module":null,"name":"ReactiveHTML1","overrides":[],"properties":[]},{"extends":null,"module":null,"name":"FlexBox1","overrides":[],"properties":[{"default":"flex-start","kind":null,"name":"align_content"},{"default":"flex-start","kind":null,"name":"align_items"},{"default":"row","kind":null,"name":"flex_direction"},{"default":"wrap","kind":null,"name":"flex_wrap"},{"default":"flex-start","kind":null,"name":"justify_content"}]},{"extends":null,"module":null,"name":"GridStack1","overrides":[],"properties":[{"default":"warn","kind":null,"name":"mode"},{"default":null,"kind":null,"name":"ncols"},{"default":null,"kind":null,"name":"nrows"},{"default":true,"kind":null,"name":"allow_resize"},{"default":true,"kind":null,"name":"allow_drag"},{"default":[],"kind":null,"name":"state"}]},{"extends":null,"module":null,"name":"click1","overrides":[],"properties":[{"default":"","kind":null,"name":"terminal_output"},{"default":"","kind":null,"name":"debug_name"},{"default":0,"kind":null,"name":"clears"}]},{"extends":null,"module":null,"name":"NotificationAreaBase1","overrides":[],"properties":[{"default":"bottom-right","kind":null,"name":"position"},{"default":0,"kind":null,"name":"_clear"}]},{"extends":null,"module":null,"name":"NotificationArea1","overrides":[],"properties":[{"default":[],"kind":null,"name":"notifications"},{"default":"bottom-right","kind":null,"name":"position"},{"default":0,"kind":null,"name":"_clear"},{"default":[{"background":"#ffc107","icon":{"className":"fas fa-exclamation-triangle","color":"white","tagName":"i"},"type":"warning"},{"background":"#007bff","icon":{"className":"fas fa-info-circle","color":"white","tagName":"i"},"type":"info"}],"kind":null,"name":"types"}]},{"extends":null,"module":null,"name":"Notification","overrides":[],"properties":[{"default":null,"kind":null,"name":"background"},{"default":3000,"kind":null,"name":"duration"},{"default":null,"kind":null,"name":"icon"},{"default":"","kind":null,"name":"message"},{"default":null,"kind":null,"name":"notification_type"},{"default":false,"kind":null,"name":"_destroyed"}]},{"extends":null,"module":null,"name":"TemplateActions1","overrides":[],"properties":[{"default":0,"kind":null,"name":"open_modal"},{"default":0,"kind":null,"name":"close_modal"}]},{"extends":null,"module":null,"name":"MaterialTemplateActions1","overrides":[],"properties":[{"default":0,"kind":null,"name":"open_modal"},{"default":0,"kind":null,"name":"close_modal"}]}],"roots":{"references":[{"attributes":{"coordinates":null,"group":null,"text_color":"black","text_font_size":"12pt"},"id":"6824","type":"Title"},{"attributes":{},"id":"6922","type":"UnionRenderers"},{"attributes":{"axis":{"id":"6832"},"coordinates":null,"grid_line_color":null,"group":null,"ticker":null},"id":"6835","type":"Grid"},{"attributes":{"line_color":{"value":"limegreen"},"line_width":{"value":2}},"id":"6874","type":"MultiLine"},{"attributes":{},"id":"6833","type":"BasicTicker"},{"attributes":{"range":null},"id":"6891","type":"Dodge"},{"attributes":{"axis_label":"x","coordinates":null,"formatter":{"id":"6856"},"group":null,"major_label_policy":{"id":"6857"},"ticker":{"id":"6833"}},"id":"6832","type":"LinearAxis"},{"attributes":{"text":{"field":"item_category"},"text_align":{"value":"center"},"text_alpha":{"value":0.2},"text_baseline":{"value":"middle"},"text_color":{"value":"blue"},"text_font_size":{"value":"12pt"},"x":{"field":"x","transform":{"id":"6891"}},"y":{"field":"y","transform":{"id":"6892"}}},"id":"6898","type":"Text"},{"attributes":{},"id":"6857","type":"AllLabels"},{"attributes":{},"id":"6841","type":"PanTool"},{"attributes":{"coordinates":null,"data_source":{"id":"6904"},"glyph":{"id":"6907"},"group":null,"hover_glyph":null,"muted_glyph":{"id":"6909"},"nonselection_glyph":{"id":"6908"},"selection_glyph":{"id":"6912"},"view":{"id":"6911"}},"id":"6910","type":"GlyphRenderer"},{"attributes":{"axis_label":"y","coordinates":null,"formatter":{"id":"6859"},"group":null,"major_label_policy":{"id":"6860"},"ticker":{"id":"6837"}},"id":"6836","type":"LinearAxis"},{"attributes":{},"id":"6887","type":"NodesAndLinkedEdges"},{"attributes":{"axis":{"id":"6836"},"coordinates":null,"dimension":1,"grid_line_color":null,"group":null,"ticker":null},"id":"6839","type":"Grid"},{"attributes":{},"id":"6837","type":"BasicTicker"},{"attributes":{"source":{"id":"6904"}},"id":"6911","type":"CDSView"},{"attributes":{},"id":"6842","type":"WheelZoomTool"},{"attributes":{"angle":{"value":0},"text":{"field":"item_subtype"},"text_align":{"value":"center"},"text_alpha":{"value":1.0},"text_baseline":{"value":"middle"},"text_color":{"value":"black"},"text_font_size":{"value":"8pt"},"text_font_style":{"value":"normal"},"text_line_height":{"value":1.2},"x":{"field":"x","transform":{"id":"6902"}},"x_offset":{"value":0},"y":{"field":"y","transform":{"id":"6903"}},"y_offset":{"value":0}},"id":"6912","type":"Text"},{"attributes":{"text":{"field":"item_subtype"},"text_align":{"value":"center"},"text_alpha":{"value":0.2},"text_baseline":{"value":"middle"},"text_color":{"value":"black"},"text_font_size":{"value":"8pt"},"x":{"field":"x","transform":{"id":"6902"}},"y":{"field":"y","transform":{"id":"6903"}}},"id":"6909","type":"Text"},{"attributes":{},"id":"6840","type":"SaveTool"},{"attributes":{},"id":"6889","type":"NodesAndLinkedEdges"},{"attributes":{"overlay":{"id":"6846"}},"id":"6843","type":"BoxZoomTool"},{"attributes":{},"id":"6844","type":"ResetTool"},{"attributes":{"callback":null},"id":"6845","type":"TapTool"},{"attributes":{"bottom_units":"screen","coordinates":null,"fill_alpha":0.5,"fill_color":"lightgrey","group":null,"left_units":"screen","level":"overlay","line_alpha":1.0,"line_color":"black","line_dash":[4,4],"line_width":2,"right_units":"screen","syncable":false,"top_units":"screen"},"id":"6846","type":"BoxAnnotation"},{"attributes":{"margin":[5,5,5,5],"name":"HSpacer09338","sizing_mode":"stretch_width"},"id":"6929","type":"Spacer"},{"attributes":{"range":null,"value":-0.05},"id":"6903","type":"Dodge"},{"attributes":{"fill_alpha":{"value":0.2},"fill_color":{"field":"node_color","transform":{"id":"6861"}},"hatch_alpha":{"value":0.2},"hatch_color":{"field":"node_color","transform":{"id":"6861"}},"line_alpha":{"value":0.2},"size":{"value":10}},"id":"6869","type":"Circle"},{"attributes":{"coordinates":null,"data_source":{"id":"6863"},"glyph":{"id":"6872"},"group":null,"hover_glyph":{"id":"6874"},"muted_glyph":{"id":"6875"},"nonselection_glyph":{"id":"6873"},"view":{"id":"6877"}},"id":"6876","type":"GlyphRenderer"},{"attributes":{"line_alpha":{"value":0.2},"line_width":{"value":2}},"id":"6875","type":"MultiLine"},{"attributes":{"fill_color":{"field":"node_color","transform":{"id":"6861"}},"hatch_color":{"field":"node_color","transform":{"id":"6861"}},"size":{"value":10}},"id":"6867","type":"Circle"},{"attributes":{"source":{"id":"6862"}},"id":"6871","type":"CDSView"},{"attributes":{"fill_alpha":{"value":0.2},"fill_color":{"field":"node_color","transform":{"id":"6861"}},"hatch_alpha":{"value":0.2},"hatch_color":{"field":"node_color","transform":{"id":"6861"}},"line_alpha":{"value":0.2},"size":{"value":10}},"id":"6866","type":"Circle"},{"attributes":{"source":{"id":"6863"}},"id":"6877","type":"CDSView"},{"attributes":{"data":{"end":{"__ndarray__":"AQAAAA==","dtype":"int32","order":"little","shape":[1]},"start":{"__ndarray__":"AAAAAA==","dtype":"int32","order":"little","shape":[1]},"xs":[{"__ndarray__":"/f//////778AAAAAAADwPwAAAAAAAPh/o0+UeuJn7j8AAAAAAADwP7MVpUGkOu8/","dtype":"float64","order":"little","shape":[6]}],"ys":[{"__ndarray__":"Q/rPMC7k6j9C+s8wLuTqvwAAAAAAAPh/PxtrCCxj6r9C+s8wLuTqvxKuJmhgaOm/","dtype":"float64","order":"little","shape":[6]}]},"selected":{"id":"6928"},"selection_policy":{"id":"6927"}},"id":"6863","type":"ColumnDataSource"},{"attributes":{"coordinates":null,"data_source":{"id":"6893"},"glyph":{"id":"6896"},"group":null,"hover_glyph":null,"muted_glyph":{"id":"6898"},"nonselection_glyph":{"id":"6897"},"selection_glyph":{"id":"6901"},"view":{"id":"6900"}},"id":"6899","type":"GlyphRenderer"},{"attributes":{"line_alpha":{"value":0.2},"line_width":{"value":2}},"id":"6873","type":"MultiLine"},{"attributes":{},"id":"6925","type":"UnionRenderers"},{"attributes":{},"id":"6926","type":"Selection"},{"attributes":{"range":null,"value":0.05},"id":"6892","type":"Dodge"},{"attributes":{"coordinates":null,"data_source":{"id":"6862"},"glyph":{"id":"6865"},"group":null,"hover_glyph":{"id":"6868"},"muted_glyph":{"id":"6869"},"nonselection_glyph":{"id":"6866"},"selection_glyph":{"id":"6867"},"view":{"id":"6871"}},"id":"6870","type":"GlyphRenderer"},{"attributes":{"line_width":{"value":2}},"id":"6872","type":"MultiLine"},{"attributes":{"text":{"field":"item_category"},"text_align":{"value":"center"},"text_baseline":{"value":"middle"},"text_color":{"value":"blue"},"text_font_size":{"value":"12pt"},"x":{"field":"x","transform":{"id":"6891"}},"y":{"field":"y","transform":{"id":"6892"}}},"id":"6896","type":"Text"},{"attributes":{},"id":"6894","type":"Selection"},{"attributes":{"factors":["ENTITY","ACTIVITY"],"palette":["blue","orange"]},"id":"6861","type":"CategoricalColorMapper"},{"attributes":{"data":{"item_category":["ENTITY","ACTIVITY"],"x":{"__ndarray__":"/f//////778AAAAAAADwPw==","dtype":"float64","order":"little","shape":[2]},"y":{"__ndarray__":"Q/rPMC7k6j9C+s8wLuTqvw==","dtype":"float64","order":"little","shape":[2]}},"selected":{"id":"6894"},"selection_policy":{"id":"6920"}},"id":"6893","type":"ColumnDataSource"},{"attributes":{"tools":[{"id":"6822"},{"id":"6840"},{"id":"6841"},{"id":"6842"},{"id":"6843"},{"id":"6844"},{"id":"6845"}]},"id":"6847","type":"Toolbar"},{"attributes":{"text":{"field":"item_category"},"text_align":{"value":"center"},"text_alpha":{"value":0.1},"text_baseline":{"value":"middle"},"text_color":{"value":"blue"},"text_font_size":{"value":"12pt"},"x":{"field":"x","transform":{"id":"6891"}},"y":{"field":"y","transform":{"id":"6892"}}},"id":"6897","type":"Text"},{"attributes":{"angle":{"value":0},"text":{"field":"item_category"},"text_align":{"value":"center"},"text_alpha":{"value":1.0},"text_baseline":{"value":"middle"},"text_color":{"value":"blue"},"text_font_size":{"value":"12pt"},"text_font_style":{"value":"normal"},"text_line_height":{"value":1.2},"x":{"field":"x","transform":{"id":"6891"}},"x_offset":{"value":0},"y":{"field":"y","transform":{"id":"6892"}},"y_offset":{"value":0}},"id":"6901","type":"Text"},{"attributes":{},"id":"6856","type":"BasicTickFormatter"},{"attributes":{"source":{"id":"6893"}},"id":"6900","type":"CDSView"},{"attributes":{},"id":"6859","type":"BasicTickFormatter"},{"attributes":{},"id":"6828","type":"LinearScale"},{"attributes":{},"id":"6860","type":"AllLabels"},{"attributes":{"end":1.15,"reset_end":1.15,"reset_start":-1.1499999999999997,"start":-1.1499999999999997,"tags":[[["x","x",null]]]},"id":"6820","type":"Range1d"},{"attributes":{"data":{"index":{"__ndarray__":"AAAAAAEAAAA=","dtype":"int32","order":"little","shape":[2]},"index_hover":["10378.1/1688634","10378.1/1691200"],"item_category":["ENTITY","ACTIVITY"],"item_subtype":["DATASET","MODEL_RUN"],"node_color":["ENTITY","ACTIVITY"]},"selected":{"id":"6926"},"selection_policy":{"id":"6925"}},"id":"6862","type":"ColumnDataSource"},{"attributes":{},"id":"6927","type":"UnionRenderers"},{"attributes":{},"id":"6928","type":"Selection"},{"attributes":{},"id":"6905","type":"Selection"},{"attributes":{"graph_layout":{"0":[-0.9999999999999997,0.8403540566794806],"1":[1.0,-0.8403540566794805]}},"id":"6864","type":"StaticLayoutProvider"},{"attributes":{"callback":null,"renderers":[{"id":"6878"}],"tags":["hv_created"],"tooltips":[["index","@{index_hover}"],["item_category","@{item_category}"],["item_subtype","@{item_subtype}"]]},"id":"6822","type":"HoverTool"},{"attributes":{"margin":[5,5,5,5],"name":"HSpacer09337","sizing_mode":"stretch_width"},"id":"6819","type":"Spacer"},{"attributes":{"background_fill_color":"white","below":[{"id":"6832"}],"center":[{"id":"6835"},{"id":"6839"}],"left":[{"id":"6836"}],"margin":[5,5,5,5],"min_border_bottom":10,"min_border_left":10,"min_border_right":10,"min_border_top":10,"renderers":[{"id":"6878"},{"id":"6899"},{"id":"6910"}],"sizing_mode":"fixed","title":{"id":"6824"},"toolbar":{"id":"6847"},"width":800,"x_range":{"id":"6820"},"x_scale":{"id":"6828"},"y_range":{"id":"6821"},"y_scale":{"id":"6830"}},"id":"6823","subtype":"Figure","type":"Plot"},{"attributes":{},"id":"6920","type":"UnionRenderers"},{"attributes":{"fill_color":{"value":"limegreen"},"hatch_color":{"field":"node_color","transform":{"id":"6861"}},"size":{"value":10}},"id":"6868","type":"Circle"},{"attributes":{"children":[{"id":"6819"},{"id":"6823"},{"id":"6929"}],"margin":[0,0,0,0],"name":"Row09333","tags":["embedded"]},"id":"6818","type":"Row"},{"attributes":{},"id":"6830","type":"LinearScale"},{"attributes":{"data":{"item_subtype":["DATASET","MODEL_RUN"],"x":{"__ndarray__":"/f//////778AAAAAAADwPw==","dtype":"float64","order":"little","shape":[2]},"y":{"__ndarray__":"Q/rPMC7k6j9C+s8wLuTqvw==","dtype":"float64","order":"little","shape":[2]}},"selected":{"id":"6905"},"selection_policy":{"id":"6922"}},"id":"6904","type":"ColumnDataSource"},{"attributes":{"end":1.0084248680153767,"reset_end":1.0084248680153767,"reset_start":-1.0084248680153767,"start":-1.0084248680153767,"tags":[[["y","y",null]]]},"id":"6821","type":"Range1d"},{"attributes":{"range":null},"id":"6902","type":"Dodge"},{"attributes":{"coordinates":null,"edge_renderer":{"id":"6876"},"group":null,"inspection_policy":{"id":"6889"},"layout_provider":{"id":"6864"},"node_renderer":{"id":"6870"},"selection_policy":{"id":"6887"}},"id":"6878","type":"GraphRenderer"},{"attributes":{"text":{"field":"item_subtype"},"text_align":{"value":"center"},"text_alpha":{"value":0.1},"text_baseline":{"value":"middle"},"text_color":{"value":"black"},"text_font_size":{"value":"8pt"},"x":{"field":"x","transform":{"id":"6902"}},"y":{"field":"y","transform":{"id":"6903"}}},"id":"6908","type":"Text"},{"attributes":{"fill_color":{"field":"node_color","transform":{"id":"6861"}},"hatch_color":{"field":"node_color","transform":{"id":"6861"}},"size":{"value":10}},"id":"6865","type":"Circle"},{"attributes":{"text":{"field":"item_subtype"},"text_align":{"value":"center"},"text_baseline":{"value":"middle"},"text_color":{"value":"black"},"text_font_size":{"value":"8pt"},"x":{"field":"x","transform":{"id":"6902"}},"y":{"field":"y","transform":{"id":"6903"}}},"id":"6907","type":"Text"}],"root_ids":["6818"]},"title":"Bokeh Application","version":"2.4.3"}}
        </script>
        <script type="text/javascript">
          (function() {
            const fn = function() {
              Bokeh.safely(function() {
                (function(root) {
                  function embed_document(root) {
                  const docs_json = document.getElementById('7059').textContent;
                  const render_items = [{"docid":"2a1aad01-9541-4f2c-887e-3d35bbd6ecc3","root_ids":["6818"],"roots":{"6818":"339bf584-8b4f-4908-8aa7-4f87d6590f3c"}}];
                  root.Bokeh.embed.embed_items(docs_json, render_items);
                  }
                  if (root.Bokeh !== undefined) {
                    embed_document(root);
                  } else {
                    let attempts = 0;
                    const timer = setInterval(function(root) {
                      if (root.Bokeh !== undefined) {
                        clearInterval(timer);
                        embed_document(root);
                      } else {
                        attempts++;
                        if (attempts > 100) {
                          clearInterval(timer);
                          console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
                        }
                      }
                    }, 10, root)
                  }
                })(window);
              });
            };
            if (document.readyState != "loading") fn();
            else document.addEventListener("DOMContentLoaded", fn);
          })();
        </script>
  </body>
</html>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="#toc">Return to Top</a></p>

</div>
</div>
</div>
</div>
 

